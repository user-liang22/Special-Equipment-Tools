// 页面加载时显示使用说明弹窗（仅移动端，且仅第一次）
document.addEventListener('DOMContentLoaded', function() {
    // 检查是否为移动端
    const isMobile = window.innerWidth <= 768;
    
    if (isMobile) {
        // 检查是否已经显示过使用说明
        const hasShownInstructions = localStorage.getItem('hasShownInstructions');
        
        if (!hasShownInstructions) {
            // 延迟显示弹窗，确保页面完全加载
            setTimeout(() => {
                showInstructionsModal();
            }, 500);
        }
    }
});

// 显示使用说明弹窗
function showInstructionsModal() {
    const modal = document.getElementById('instructions-modal');
    if (modal) {
        modal.style.display = 'block';
        
        // 标记已显示过使用说明
        localStorage.setItem('hasShownInstructions', 'true');
        
        // 添加关闭事件监听器
        const closeBtn = modal.querySelector('.close');
        const gotItBtn = document.getElementById('got-it-btn');
        
        if (closeBtn) {
            closeBtn.addEventListener('click', () => {
                modal.style.display = 'none';
            });
        }
        
        if (gotItBtn) {
            gotItBtn.addEventListener('click', () => {
                modal.style.display = 'none';
            });
        }
        
        // 点击弹窗外部关闭
        modal.addEventListener('click', (e) => {
            if (e.target === modal) {
                modal.style.display = 'none';
            }
        });
    }
}

// GBT 42615-2023 评估项目数据
const evaluationData = [
    { category: 'A.1 机器空间、滑轮间及警示标志评价内容', items: [
        { id: 'A.1.1', name: '机房及滑轮间警示标志', content: 'a) 在通往机房和滑轮间的门或活板门的外侧应设有警示标志\nb) 对于活板门，应设有提醒使用者谨防坠落的警示标志', risks: ['Ⅱ'] , severity: "2,3", probability: "C,D"},
        { id: 'A.1.2', name: '机器空间和滑轮间的防滑', content: '供人员工作或在工作区域之间移动的地板表面应采用防滑材料', risks: ['Ⅱ'] , severity: "2,3", probability: "D"},
        { id: 'A.1.3', name: '地面高度差和凹坑', content: 'a) 机房地面高度不一且相差大于 0.50 m 时，应设置楼梯、台阶或符合 GB/T 7588.1—2020 中 5.2.2.5 规定的固定的梯子，并设置护栏\nb) 机房地面有任何深度大于 0.05m, 宽度介于 0.05m 和 0.50 m 之间的凹坑或槽坑时，均应盖住(本要求仅适用于需要有人员工作的区域或在不同工作地点移动时的区域)', risks: ['Ⅱ'] , severity: "2,3", probability: "D"},
        { id: 'A.1.4', name: '地面开口', content: '机房和滑轮间的楼板和地面上的开口 ( 包括用于电缆穿过的开孔 ) 应采用凸缘，该凸缘应凸出楼板或完工地面至少 50 mm', risks: ['Ⅱ'] , severity: "2,3", probability: "D"},
        { id: 'A.1.5', name: '照明和插座', content: 'a) 机器空间和滑轮间应设有永久性的电气照明，照度应符合GB/T 7588.1—2020中5.2.1.4.2的要求\nb) 机器空间和滑轮间内靠近入口(或多个入口)处的适当高度应设有一个照明控制开关，仅被授权人员可接近\nc) 机器空间和滑轮间内的每个工作区域的适当位置应至少设有一个 2P+PE 型 250 V, 且直接供电的电源插座', risks: ['Ⅱ'] , severity: "2,3", probability: "D"},
        { id: 'A.1.6', name: '机房噪声', content: 'a) v≤2.5m/s，噪声≤80 dB(A)\nb) 2.5m/s < v ≤ 6m/s，噪声≤85 dB(A)', risks: ['Ⅱ'] , severity: "3", probability: "D"},
        { id: 'A.1.7', name: '工作安全区间', content: 'a) 机房应有足够的空间，符合GB/T 7588.1—2020中5.2.6.3.2.1的要求，以允许人员安全和容易地对有关设备进行作业，尤其是对电气设备的作业\nb) 活动区域的净高度和通道宽度符合GB/T 7588.1—2020中5.2.6.3.2.2要求\nc) 在无防护的电梯驱动主机旋转部件及滑轮的上方的净垂直距离应符合GB/T 7588.1—2020中5.2.6.3.2.3的要求', risks: ['Ⅱ'] , severity: "2,3", probability: "D"},
        { id: 'A.1.8', name: '旋转部件的安全防护', content: 'a) 对可能产生危险并可能接近的旋转部件，应提供有效的防护，但带有防护装置的曳引轮、盘车手轮、制动轮及任何类似的光滑圆形部件除外。这些部件应涂成黄色，至少部分地涂成黄色\nb) 所采用的防护装置安装后，应能见到旋转部件且不妨碍检查与维护工作。若防护装置是网孔型的，则应符合 GB/T 23821—2009中4.2.4.1表4的要求', risks: ['Ⅱ'] , severity: "1,2", probability: "C,D"},
        { id: 'A.1.9', name: '限速器', content: '限速器应有有效期内的校验证书，且不应出现下列情况之一：\na)  运行中有异响\nb)  传动部件严重锈蚀\nc)  轴承损坏导致限速器轮转动不灵活\nd)  限速器座变形\ne)  限速器绳表面油污严重\nf)  限速器绳达到或接近达到GB/T31821—2015中4.4.2的报废技术条件\ng)  限速器的动作速度和限速器绳的提拉力不符合GB/T 7588.1—2020中5.6.2.2.1.1的要求', risks: ['I', 'Ⅱ'] , severity: "1,2", probability: "C,D"},
        { id: 'A.1.10', name: '作用于钢丝绳系统的减速元件', content: '作用于钢丝绳系统的减速元件不应出现下列情况之一：\na)  触发联动机构卡阻或损坏\nb)  钳体或制动弹簧出现塑性变形、裂纹或断裂\nc)  夹紧件严重磨损或锈蚀\nd)  夹紧件擦碰钢丝绳\ne)  复位装置卡阻或损坏', risks: ['I', 'Ⅱ'], severity: "1,2", probability: "C,D" },
        { id: 'A.1.11', name: '机房和滑轮间的专用', content: '机房和滑轮间不应用于电梯以外的其他用途，也不应设置非电梯用的线槽、电缆或装置', risks: ['Ⅱ'] , severity: "2,3", probability: "D"}
    ]},
    { category: 'A.2 减速箱和曳引轮评价内容', items: [
        { id: 'A.2.1', name: '减速箱箱体', content: '不应出现裂纹', risks: ['Ⅱ'] , severity: "2,3", probability: "D"},
        { id: 'A.2.2', name: '减速箱固定', content: '固定结构牢固无严重锈蚀，或无影响安全运行的损坏', risks: ['I', 'Ⅱ'] , severity: "1,2", probability: "C,D"},
        { id: 'A.2.3', name: '传动结构', content: 'a) 传动轴、轴承、键/键槽无影响安全运行的损坏，无异常噪声\nb) 蜗轮副、斜齿轮、行星齿轮无影响安全运行的轮齿塑性变形、折断、裂纹、齿面点蚀、胶合或磨损等形式的严重失效', risks: ['I', 'Ⅱ'] , severity: "1,2", probability: "C,D"},
        { id: 'A.2.4', name: '渗漏油情况', content: '有齿轮曳引机的箱体分割面、观察窗(孔)盖等处应紧密连接，不应渗漏油', risks: ['Ⅱ'] , severity: "3", probability: "D"},
        { id: 'A.2.5', name: '齿轮油', content: 'a) 齿轮油油位正常\nb) 齿轮油应清洁无污物或泡沫，无明显浑浊和变色', risks: ['Ⅱ'] , severity: "3", probability: "D"},
        { id: 'A.2.6', name: '曳引轮', content: 'a) 绳槽不应过度或异常磨损\nb) 绳槽不应有缺损\nc) 轮槽不应被异物填充\nd) 不应出现裂纹', risks: ['I', 'Ⅱ'] , severity: "2,3", probability: "B,C"},        
    ]},
    { category: 'A.3 联轴器评价内容', items: [
        { id: 'A.3.1', name: '金属疲劳', content: '两个半联轴器的金属件，尤其是螺栓孔处不应出现裂纹、变形和明显磨损', risks: ['Ⅱ'] , severity: "1,2", probability: "E"},
        { id: 'A.3.2', name: '联结情况', content: 'a) 联轴器与电动机输出轴端、减速箱联结装置应固定可靠\nb) 运转中联轴器不应有振动、冲击和异响\nc) 联轴器挡圈、柱销等组件应完好', risks: ['Ⅱ'] , severity: "2,3", probability: "C,D"},
        { id: 'A.3.3', name: '外观', content: '弹性联轴器的非金属缓冲件不应出现过度磨损、开裂、严重变形和老化', risks: ['Ⅱ'] , severity: "3", probability: "C,D"}
    ]},
    { category: 'A.4 电动机评价内容', items: [
        { id: 'A.4.1', name: '轴承润滑', content: '轴承润滑状况应良好', risks: ['Ⅱ'] , severity: "3", probability: "C"},
        { id: 'A.4.2', name: '绝缘', content: '定子绕组冷态绝缘电阻不应小于5MΩ', risks: ['I'] , severity: "1,2", probability: "B"},
        { id: 'A.4.3', name: '电动机运转状况', content: '电动机不应出现下列情况之一：\na)  绕组短路、断路、烧毁\nb)  外壳或基座有影响安全的破裂\nc)  轴承出现碎裂或影响运行的磨损\nd)  定子与转子发生碰擦\ne)  定子的温升或绝缘不符合GB/T 24478—2009中4.2.1.2的要求\nf)  噪声不符合GB/T 24478—2009中4.2.3.3的要求\ng)  三相异步电动机定子绕组不平衡，或永磁同步电动机出现退磁，不能满足110%超载试验的扭矩要求\nh)  永磁同步电动机转子磁性材料脱落', risks: ['I','Ⅱ'] , severity: "2,3", probability: "C,D"},
        { id: 'A.4.4', name: '保护', content: '电动机的过热保护应有效', risks: ['Ⅱ'] , severity: "3", probability: "C,D"},
        { id: 'A.4.5', name: '编码器', content: 'a)  编码器应结构完整，安装可靠\nb)  编码器信号输出应正常', risks: ['Ⅱ'] , severity: "3", probability: "C,D"}
    ]},
    { category: 'A.5 制动器评价内容', items: [
        { id: 'A.5.1', name: '制动器型式', content: '机电式制动器应符合下列要求：\na) 所有参与向制动面施加制动力的制动器机械部件应至少分两组设置\nb) 电梯正常运行时，切断制动器电流应至少用两个独立的电气装置来实现，当电梯停止时，如果其中一个接触器的主触点未打开，最迟到下一次运行方向改变时，应防止电梯再运行', risks: ['I', 'Ⅱ'] , severity: "1,2", probability: "C,D"},
        { id: 'A.5.2', name: '制动器结构检查', content: '制动器不应出现下列情况之一：\na)  制动衬块严重磨损或者制动弹簧失效，导致制动力不足\nb)  受力结构件出现裂纹或者严重磨损\nc)  制动器电磁线圈防尘件破损\nd)  制动衬块(制动钳)以及制动面上有油污', risks: ['I'] , severity: "1,2", probability: "B"},
        { id: 'A.5.3', name: '制动器响应时间', content: '制动器电磁铁的动铁芯动作不应出现卡阻等异常现象，且响应时间应符合GB/T 24478—2009中4.2.2.3的要求', risks: ['I'] , severity: "1,2", probability: "B"},
        { id: 'A.5.4', name: '工作状况', content: '制动器应动作灵活，制动时制动衬块(制动钳)应紧密、均匀地贴合在制动面上；电梯运行时制动衬块(制动钳)不应与制动面发生摩擦', risks: ['I','Ⅱ'] , severity: "2,3", probability: "C"},
        { id: 'A.5.5', name: '动作电压', content: '在满足GB/T 24478—2009中4.2.2.2情况下，制动器电磁铁的最低吸合电压和最高释放电压应分别低于额定电压的80%和55%', risks: ['Ⅱ'] , severity: "3", probability: "C"},
        { id: 'A.5.6', name: '制动器自监测装置', content: '在使用驱动主机制动器作为轿厢意外移动保护装置制停部件的情况下，自监测包括对每组机械装置正确提起(或释放)的验证和(或)对每组机械装置作用下制动力的验证。\n自监测应符合下列要求之一：\na)  制动力自监测周期不大于24 h\nb)  制动力自监测的周期大于24 h,且对机械装置正确提起(或释放)进行验证，制动力自监测的周期不超过制造单位的设计值\nc)  仅对机械装置正确提起(或释放)验证的，按制造单位确定的周期进行制动器定期维护保养时检测制动力', risks: ['I','Ⅱ'] , severity: "1,2", probability: "D"}
    ]},
    { category: 'A.6 救援装置评价内容', items: [
        { id: 'A.6.1', name: '设置', content: 'a)  紧急操作装置应按以下要求设置：\n   1)  符合GB/T 7588.1—2020中5.9.2.3.1a)规定的手动操作机械装置；或\n   2)  符合GB/T7588.1—2020中5.9.2.3.1b)规定的手动操作电动装置；或\n   3)  符合GB/T7588.1—2020中5.1,2.1.6规定的紧急电动运行控制装置\nb)  紧急和测试操作屏应具有显示装置或直接观察驱动主机的观察窗，应能获得下列信息：\n 1)  轿厢运行的方向\n 2)  轿厢到达开锁区域\n 3)  轿厢的速度\nc)  紧急和测试操作装置上应采用永久安装的电气照明\nd)  紧急和测试操作装置上应设置停止装置(除非在1 m 之内可直接操作主开关或其他停止装置)\ne)  当机器在井道内时，应在紧急和测试操作屏上设置必要的紧急和测试操作装置，以便在井道外进行所有的电梯紧急操作和动态测试，例如：曳引、安全钳、缓冲器、轿厢上行超速保护、轿厢意外移动保护、破裂阀、节流阀、棘爪装置、缓冲停止和压力等测试。只有被授权人员才能接近该屏', risks: ['Ⅱ'] , severity: "2,3", probability: "D"},
        { id: 'A.6.2', name: '标志', content: 'a)  在电梯机房内、机器柜内或在紧急和测试操作屏上，应设置详细的说明，指出电梯发生故障时应遵守的规程，尤其应包括救援操作装置和三角钥匙的使用说明\nb)  如果盘车手轮用于紧急操作，则轿厢运动方向应清晰地标在驱动主机上靠近盘车手轮的位置。如果盘车手轮是不可拆卸的，则轿厢运动方向可标在盘车手轮上\nc)  紧急电动运行应清楚地标明运行方向\nd)  松闸扳手涂成红色，盘车手轮是无辐条的并且涂成黄色，可拆卸盘车手轮放置在机房内容易接近的明显部位', risks: ['Ⅱ'] , severity: "2,3", probability: "D"},
        { id: 'A.6.3', name: '功能有效性', content: 'a)  应能采用持续手动操作的方法打开驱动主机制动器\nb)  操作紧急电动运行开关后，应允许持续按压具有防止意外操作保护的按钮控制轿厢运行\nc)  检修运行一旦实施，紧急电动运行应失效：\n    1)  检修运行过程中，如果紧急电动运行开关动作，则紧急电动运行无效，检修运行的上行、下行和"运行"按钮仍保持有效\n    2)  紧急电动运行过程中，如果检修运行开关动作，则紧急电动运行变为无效，而检修运行上行、下行和"运行"按钮变为有效', risks: ['Ⅱ'] , severity: "2", probability: "D"},
        { id: 'A.6.4', name: '平层标志', content: '应能易于检查轿厢是否在开锁区域', risks: ['Ⅱ'] , severity: 3, probability: "D"},
        { id: 'A.6.5', name: '制动器手动机械操作装置', content: '手动机械操作装置制动器扳手不应出现严重变形或裂纹，制动器扳手组件不应出现严重锈蚀、变形或裂纹，拉索元件不应出现严重锈蚀、卡阻或断裂', risks: ['Ⅱ'] , severity: 3, probability: "D"},
        { id: 'A.6.6', name: '手动盘车装置', content: 'a)  对于可拆卸盘车手轮，设有一个电气安全装置，最迟在盘车手轮装上电梯驱动主机时动作\nb)  盘车手轮不应出现严重锈蚀、变形、裂纹或缺损，焊接部位不应出现裂纹，盘车齿轮副啮合有效，盘车齿轮无裂纹或断齿', risks: ['Ⅱ'] , severity: 3, probability: "D"},
        { id: 'A.6.7', name: '紧急电源', content: '紧急电源的蓄电池不应出现以下情况之一：\na)  蓄电池出现漏液\nb)  蓄电池无法充电\nc)  充电后蓄电池电压低于正常工作电压，充电后蓄电池电量不能满足设计功能要求(如持续时间、轿厢移动距离等要求)', risks: ['Ⅱ'] , severity: 3, probability: "D"},
        { id: 'A.6.8', name: '对讲系统', content: '紧急操作装置处与轿厢对讲系统应有效', risks: ['Ⅱ'] , severity: 2, probability: "D"}
    ]},
    { category: 'A.7 层门、轿门与门锁评价内容', items: [
        { id: 'A.7.1', name: '间隙', content: 'a)  轿门门刀与层门地坎、层门锁滚轮与轿厢地坎的间隙应不小于5mm;电梯运行时不应互相碰擦\nb)  门刀与门滚轮之间的间隙合理，无擦碰和异响\nc)  轿厢地坎与层门地坎的水平距离不应大于35 mm\nd)  门关闭后，应符合以下要求：\n   1)  门扇之间及门扇与立柱、门楣和地坎之间的间隙，对于乘客电梯不大于6mm;对于载货电梯不大于8 mm,使用过程中由于磨损，允许达到10 mm\n   2)  在水平滑动门和折叠门主动门扇的开启方向，以150 N的人力施加在一个最不利的点，前条所述的间隙允许增大，但对于旁开门不大于30 mm,对于中分门其总和不大于45 mm', risks: ['I','Ⅱ'] , severity: "2,3", probability: "C,D"},
        { id: 'A.7.2', name: '门扇', content: '门扇不应出现下列情况之一：\na)  门扇严重锈蚀穿孔或破损穿孔\nb)  门扇背部加强筋脱落\nc)  门扇严重变形，不符合GB/T 7588.1—2020中5.3.1.4的要求 ；\nd)  门扇外包层脱离(落),导致开关门受阻或门扇强度不符合GB/T 7588.1—2020中5.3.5.3.6的要求\ne)  玻璃门扇出现裂纹或玻璃门扇边缘出现锋利缺口\nf)  玻璃固定件不符合GB/T 7588.1—2020中5.3.5.3.6的要求', risks: ['I'] , severity: "1,2", probability: "B,C"},
        { id: 'A.7.3', name: '层门门套', content: '层门门套不应出现下列情况之一：\n   a)  层门门套严重变形，与门扇间隙不符合GB/T 7588.1—2020中5.3.1.4的要求\n   b)  层门门套严重锈蚀\n   c)  层门门套松动', risks: ['I','Ⅱ'] , severity: "2,3", probability: "C,D"},
        { id: 'A.7.4', name: '层门地坎', content: '层门地坎不应出现下列情况之一：\n a)  地坎变形，与门扇间隙不符合GB/T 7588.1—2020中5.3.1.4的要求\n b)  地坎滑槽变形，影响门扇正常运行或导致门导靴脱轨\n c)  地坎出现断裂、开焊、严重磨损或腐蚀，影响层门和轿门正常运行', risks: ['I','Ⅱ'] , severity: "2,3", probability: "C,D"},
        { id: 'A.7.5', name: '地坎支架', content: '地坎支架不应出现影响正常使用的严重变形、腐蚀、松动或缺失', risks: ['I','Ⅱ'] , severity: "2,3", probability: "C,D"},
        { id: 'A.7.6', name: '层门地坎与轿门地坎之间高度差', content: '层门地坎应具有足够的强度，层门地坎上表面宜高出装修后的地平面2 mm～5 mm。在开门宽度方向上，地坎表面相对水平面的倾斜不应大于2/1000', risks: ['I','Ⅱ'] , severity: "2,3", probability: "C,D"},
        { id: 'A.7.7', name: '门运行与导向', content: 'a)  层门和轿门正常运行时不应出现脱轨、机械卡阻或者在行程终端时错位\nb)  如果磨损、锈蚀或者火灾可能造成层门导向装置失效，应设置应急导向装置，使层门保持在原有位置', risks: ['I'] , severity: "1,2", probability: "B,C"},
        { id: 'A.7.8', name: '层门自动关闭装置', content: '在轿门驱动层门的情况下，当轿厢在开锁区域之外时，如果层门开启(无论何种原因),应有一种装置能够确保该层门自动关闭。自动关闭装置采用重块时，应有防止重块坠落的措施', risks: ['I'] , severity: 1, probability: "B,C"},
        { id: 'A.7.9', name: '层门和轿门锁紧装置', content: 'a)  每个层门都应设置门锁装置，应由重力、永久磁铁或者弹簧来产生和保持锁紧动作，即使永久磁铁或者弹簧失效，重力亦不能导致开锁\nb)  轿厢应在锁紧元件啮合不小于7 mm时才能启动\nc)  门的锁紧应由一个电气安全装置来验证，该装置应由锁紧元件强制操作而没有任何中间机构，并且能够防止误动作\nd)  如果轿门采用了门锁装置，该装置也应符合以上有关要求', risks: ['I'] , severity: 1, probability: "B,C"},
        { id: 'A.7.10', name: '门锁电气安全装置', content: 'a)  正常运行时应不能打开层门，除非轿厢在该层门的开锁区域内停止或停站；如果一个层门或者轿门(或者多扇门中的任何一扇门)开着，在正常操作情况下，应不能启动电梯或者不能保持继续运行\nb)每个层门和轿门的闭合都应由电气安全装置来验证，如果滑动门是由数个间接机械连接的门扇组成，则未被锁住的门扇上也应设置电气安全装置以验证其闭合状态\nc)  门锁触点不应有短接、污染、变形，防护罩应齐全', risks: ['I'] , severity: 1, probability: "B,C"},
        { id: 'A.7.11', name: '自动门的防护装置', content: '动力驱动的自动水平滑动门应设置防止门夹人的保护装置，当人员通过层门入口被正在关闭的门扇撞击或者将被撞击时，该装置应自动使门重新开启', risks: ['I'] , severity: "1,2", probability: "B,C"},
        { id: 'A.7.12', name: '玻璃门防拖曳措施', content: '层门和轿门采用玻璃门时，应有防止儿童的手被拖曳的措施', risks: ['I','Ⅱ'] , severity: "2,3", probability: "C,D"},
        { id: 'A.7.13', name: '层门、轿门运动相关的保护', content: '为了避免运行期间发生剪切的危险，动力驱动的自动滑动门外表面不应有大于3 mm的凹进或凸出部分，这些凹进或凸出部分的边缘应在开门运行方向上倒角', risks: ['I','Ⅱ'] , severity: "2,3", probability: "C,D"},
        { id: 'A.7.14', name: '开关门的限制', content: 'a)  轿厢在开锁区域时，应能在轿厢所在层站，用三角钥匙开锁或通过轿门使层门开锁后或轿厢内用不超过300 N的力，手动打开轿门和层门\nb)  在轿厢运行时，开启轿门的力应大于50 N\nc)  轿门应有开门限制装置，在开门限制装置处施加1000 N的力，轿门开启不能超过50 mm', risks: ['I'] , severity: "1,2", probability: "B,C"},
        { id: 'A.7.15', name: '层门护脚板', content: '应是连续的，由光滑而坚硬的材料构成', risks: ['Ⅱ'] , severity: 3, probability: "C,D"},
        { id: 'A.7.16', name: '门机', content: '门机绝缘电阻应符合GB/T 7588.1—2020中5.10.1.3的要求', risks: ['I'] , severity: "1,2", probability: "B,C"},
        { id: 'A.7.17', name: '三角形开锁装置', content: 'a)  每个层门均应能够被一把符合要求的三角钥匙从外面开启。紧急开锁后，在层门闭合时门锁装置不应保持开锁位置\nb)  三角形开锁装置的位置应符合GB/T 7588.1—2020中5.3.9.3.2的要求\nc)  有紧急开锁警示标识并保持完好', risks: ['Ⅱ'] , severity: 3, probability: "C,D"},
        { id: 'A.7.18', name: '其他固定和结构', content: '门系统其他固定和结构部件应固定可靠，不应有严重变形、磨损、锈蚀等缺陷', risks: ['I'] , severity: "1,2", probability: "B,C"}
    ]},
    { category: 'A.8 供电设备评价内容', items: [
        { id: 'A.8.1', name: '供电电压', content: '供电电压相对于额定电压的波动应在士7%的范围内', risks: ['Ⅱ'] , severity: 3, probability: "C,D"},
        { id: 'A.8.2', name: '主开关', content: 'a)  每台电梯应单独装设主开关，主开关应易于接近和操作；无机房电梯主开关的设置还应符合以下要求：\n    1)  如果控制柜不是安装在井道内，主开关应安装在控制柜内，如果控制柜安装在井道内，主开关应设置在紧急操作和动态测试装置上\n    2)  如果从控制柜处不容易直接操作主开关，该控制柜应设置能分断主电源的断路器\n    3)  在电梯驱动主机附近1m之内，应有可以接近的主开关或者符合要求的停止装置，且能够方便地进行操作\nb)  主开关不应切断轿厢照明和通风、机房(机器设备间)照明和电源插座、轿顶与底坑的电源插座、电梯井道照明、报警装置的供电电路\nc)  主开关应具有稳定的断开和闭合位置，并且在断开位置时能用挂锁或其他等效装置锁住，能够有效地防止误操作\nd)  如果不同电梯的部件共用一个机房，则每台电梯的主开关应与驱动主机、控制柜、限速器等采用相同的标志', risks: ['I','Ⅱ'] , severity: "2,3", probability: "C,D"},
        { id: 'A.8.3', name: '接地', content: 'a)  供电电源自进入机房(机器设备间)起，中性导体(N,零线)与保护导体(PE,地线)应始终分开\nb)  所有电气设备及线管、线槽的外露可以导电部分应与保护导体(PE,地线)可靠连接\nc)  除36V及以下安全电压外的电气设备金属罩壳均应设有易于识别的接地端，且应有良好的接地\nd)  接地线应采用黄绿双色绝缘电线分别直接接至接地端上，不应互相串接后再接地', risks: ['I','Ⅱ'] , severity: 1, probability: "C,D"},
        { id: 'A.8.4', name: '电动机和其他电气设备的保护', content: 'a) 直接与主电源连接的电动机应进行短路保护\nb) 直接与主电源连接的电动机应采用自动断路器进行过载保护，该断路器应切断电动机的所有供电', risks: ['Ⅱ'] , severity: 3, probability: "C,D"},
        { id: 'A.8.5', name: '主开关容量', content: '应符合电梯制造单位、设备运行实际需要等相关要求', risks: ['Ⅱ'] , severity: 3, probability: "C,D"},
        { id: 'A.8.6', name: '接线', content: '电梯动力线路和控制线路宜分离敷设或者采取屏蔽措施', risks: ['I','Ⅱ'] , severity: 3, probability: "B,C"},
        { id: 'A.8.7', name: '绝缘性能', content: '所有通电导体与地之间的绝缘电阻的最小值（额定100 VA及以下的PELV和SELV电路除外）应符合以下要求：\n  a) 对于大于100 VA的SELV和PELV电路，应在250V直流测试电压下进行测试，其绝缘电阻不应小于0.5 MΩ\n  b) 对于额定电压小于或等于500V的电路（包括FELV），应在500V直流测试电压下进行测试，其绝缘电阻不应小于1.0 MΩ\n  c) 对于额定电压大于500V的电路，应在1000V直流测试电压下进行测试，其绝缘电阻不应小于1.0 MΩ\nSELV:安全特低电压。\nPELV:保护特低电压。\nFELV:功能特低电压。', risks: ['I'] , severity: "1,2", probability: "B"}
    ]},
    { category: 'A.9 井道评价内容', items: [
        { id: 'A.9.1', name: '随行电缆', content: 'a)  随行电缆(含监控线)不应出现下列情况之一：\n   1)  护套出现开裂，导致线芯外露\n   2)  绝缘材料发生破损、老化，导致线芯外露或绝缘电阻不符合GB/T 7588.1—2020中5.10.1.3的要求\n   3)  线芯发生断裂或短路，电缆的备用线无法满足需要\n   4)  电缆严重变形、扭曲\nb)  随行电缆应固定良好，避免与限速器绳、选层器钢带、限位与极限开关等装置干涉，当轿厢压实在缓冲器上时，随行电缆活动部分不应与地面和轿厢底边框接触', risks: ['Ⅱ'] , severity: 3, probability: "D"},
        { id: 'A.9.2', name: '补偿链(缆)及导向装置', content: '补偿链(缆)及导向装置不应出现下列情况之一：\na)  全包覆型补偿链(缆)表面包裹材料出现脱落、严重开裂或磨损\nb)  补偿链(缆)导向装置滚轮变形、缺损、严重磨损或出现卡阻\nc)  链环表面有严重的锈蚀或脱焊，存在破断风险', risks: ['I','Ⅱ'] , severity: "2,3", probability: "C,D"},
        { id: 'A.9.3', name: '通道门、安全门和检修门的设置', content: 'a)  不应向井道、机房或滑轮间内开启\nb)设置用钥匙开启的锁，开启后不用钥匙亦能关闭并锁住\nc)  即使在锁闭状态，也可从井道、机房或滑轮间内不用钥匙打开\nd)  应设置电气安全装置以验证门的关闭状态\n注：对于通往机房、滑轮间的通道门以及不是通向危险区域的底坑通道门，可不必设置电气安全装置。', risks: ['I'] , severity: "1,2", probability: "C,D"},
        { id: 'A.9.4', name: '通道门、安全门和检修门的状态', content: '通道门、安全门和检修门不应出现下列情况之一：\na)  门扇严重锈蚀、穿孔\nb)  门扇严重变形，不符合GB/T7588.1—2020中5.2.3.3f)的要求\nc)  门锁及周边出现锈蚀，导致门锁无法可靠固定', risks: ['I'] , severity: "1,2", probability: "C,D"},
        { id: 'A.9.5', name: '井道照明', content: '井道应设置永久安装的电气照明装置，即使所有的门关闭时，轿厢位于井道内整个行程的任何位置也能达到下列要求的照度：\na)  轿顶垂直投影范围内轿顶以上1.0 m处的照度至少为50 lx\nb)  底坑地面人员可以站立、工作和(或)工作区域之间移动的任何地方，地面以上1.0 m处的照度至少为50 lx\nc)  在a)和b)规定的区域之外，照度至少为20 lx,但轿厢或部件形成的阴影除外', risks: ['Ⅱ'] , severity: 3, probability: "D"},
        { id: 'A.9.6', name: '层门地坎下的井道壁凸出物', content: '每个层门地坎下的井道壁的任何凸出物不应超过5mm,超过2 mm的凸出物应倒角，倒角与水平的夹角至少为75°', risks: ['Ⅱ'] , severity: 3, probability: "D"},
        { id: 'A.9.7', name: '极限开关', content: '应在轿厢行程的顶部和底部设置极限开关(对于液压电梯仅设置在轿厢行程的顶部),极限开关应设置在尽可能接近端站时起作用而无误动作危险的位置。极限开关应在轿厢或对重(如果有)接触缓冲器之前或柱塞接触缓冲停止装置之前起作用，并在缓冲器被压缩期间或柱塞在缓冲停止区期间保持其动作状态', risks: ['I'] , severity: "1,2", probability: "C"},
        { id: 'A.9.8', name: '平层感应装置', content: '电梯平层感应装置功能应工作可靠。平层准确度宜在±10 mm的范围内，平层保持精度宜在±20 mm的范围内', risks: ['Ⅱ'] , severity: 3, probability: "C,D"},
        { id: 'A.9.9', name: '轿厢与井道壁距离', content: '轿厢与面对轿厢入口的井道壁的间距不大于0.15 m,对于局部高度不大于0.5 m或者采用垂直滑动门的载货电梯，该间距可以增加到0.20 m。如果轿厢装有机械锁紧的门并且门只能在开锁区域内打开时，则上述间距不受限制', risks: ['I'] , severity: "1,2", probability: "C,D"},
        { id: 'A.9.10', name: '井道爬梯', content: '当相邻两层门地坎的距离大于11 m时，如井道内设置固定式钢斜梯或有安全护笼的固定式钢直梯，其应符合GB/T 7588.1—2020中5.2.3.1的要求', risks: ['Ⅱ'] , severity: 3, probability: "C,D"},
        { id: 'A.9.11', name: '通道门和安全门警告标识', content: '通道门和安全门警告标识应符合GB/T 7588.1—2020中5.2.4.2的要求', risks: ['I','Ⅱ'] , severity: "2,3", probability: "C,D"},
        { id: 'A.9.12', name: '旋转部件防护', content: '对可能产生危险并可能接近的旋转部件，应提供有效的防护', risks: ['I','Ⅱ'] , severity: "1,2", probability: "C,D"},
        { id: 'A.9.13', name: '作用于轿厢或对重的减速元件(如安全钳、对重安全钳、夹轨器等)', content: '作用于轿厢或对重的减速元件不应出现下列情况之一：\na)  钳体、夹紧件(楔块或滚柱)出现裂纹或变形\nb)  夹紧件磨损或锈蚀\nc)  弹性部件塑性变形\nd)  导向件变形或脱落\ne)  提拉装置出现锈蚀、变形、开裂、卡阻或螺纹失效', risks: ['I','Ⅱ'] , severity: "1,2", probability: "C,D"}
    ]},
    { category: 'A.10 对重(平衡重)装置评价内容', items: [
        { id: 'A.10.1', name: '滑轮和(或)链轮防护', content: 'a)  装在对重(或平衡重)上的滑轮和(或)链轮应按要求设置防护装置，以避免钢丝绳或链条因松弛而脱离绳槽或链轮、异物进入绳与绳槽或链与链轮之间\nb)  所采用的防护装置应方便观察到旋转部件且不妨碍检查与维修工作。如果防护装置是网孔型的，则应符合GB/T 23821—2009中表4的规定。防护装置只能在下列情况下才能被拆除：\n    1)  更换钢丝绳或链条\n    2)  更换绳轮或链轮\nc)  为防止钢丝绳脱离绳槽，在入槽和出槽位置附近应各设置一个防脱槽装置。如果钢丝绳在轮轴水平以下的包角大于60°且整个包角大于120°,应至少设置一个中间防脱槽装置', risks: ['I','Ⅱ'] , severity: "2,3", probability: "B,C"},
        { id: 'A.10.2', name: '对重架', content: '对重架不应出现下列情况之一：\na)  严重变形，导致导靴或对重安全钳不能正常工作\nb) 直梁、底部横梁发生变形，不能保证对重块在对重架内的可靠固定\nc)  严重腐蚀，主要受力构件断面壁厚腐蚀达设计厚度的10%', risks: ['I'] , severity: "1,2", probability: "B,C"},
        { id: 'A.10.3', name: '对重(平衡重)块', content: '对重(平衡重)块不应出现下列情况之一：\na)  开裂、严重变形或断裂\nb)  外包材料出现破损且内部材质可能向外泄露\nc)  固定不可靠\nd)  无数量标识', risks: ['I','Ⅱ'] , severity: "2,3", probability: "B,C"},
        { id: 'A.10.4', name: '井道内防护', content: '对重(平衡重)防护应符合GB/T 7588.1—2020中5.2.5.5的要求', risks: ['I','Ⅱ'] , severity: "2,3", probability: "B,C"},
        { id: 'A.10.5', name: '对重导靴', content: '对重导靴应保持清洁，不应出现变形、开裂、严重磨损', risks: ['Ⅱ'] , severity: 3, probability: "C,D"}
    ]},
    { category: 'A.11 导轨评价内容', items: [
        { id: 'A.11.1', name: '固定情况', content: 'a)  导轨和导轨支架在建筑物上的固定，应能自动地或者采用简单的调节方法，对因建筑物的正常沉降和混凝土的收缩予以补偿，应防止因导轨附件的转动造成导轨的松动\nb)  导轨与导轨支架之间应用压板固定', risks: ['I'] , severity: "1,2", probability: "B,C"},
        { id: 'A.11.2', name: '导轨顶面偏差', content: '每列导轨工作面每5m铅垂线测量值间的相对最大偏差，轿厢导轨和设有安全钳的T型对重导轨不大于1.2 mm,不设安全钳的T型对重导轨不大于2.0 mm;两列导轨顶面的距离偏差，轿厢导轨为0mm～+2 mm,对重导轨为0mm～+3 mm', risks: ['Ⅱ'] , severity: 3, probability: "C"},
        { id: 'A.11.3', name: '导轨的变形', content: '导轨不应出现影响电梯正常运行的永久变形：\na)  应保证轿厢与对重(或平衡重)的导向\nb)  导轨变形应限制在一定范围内，使得：\n   1)  不应出现门的意外开锁\n   2)  不应影响安全装置的动作\n   3)  运动部件应不会与其他部件碰撞', risks: ['I'] , severity: "1,2", probability: "B,C"},
        { id: 'A.11.4', name: '导轨表面', content: '导轨表面质量的变化不应影响电梯的安全运行(包括不应出现强度的下降及导致安全钳的制动性能的下降):\na)  T型导轨工作面不应出现影响电梯正常运行的严重损伤，空心导轨防腐保护层不应出现起皮、起瘤或脱落\nb)  导轨不应出现严重锈蚀现象\nc)  导轨不应出现严重磨损', risks: ['Ⅱ'] , severity: 3, probability: "C"},
        { id: 'A.11.5', name: '导轨支架', content: 'a)  每根导轨应至少有2个导轨支架，其间距一般不大于2.50 m(如果间距大于2.50 m应有计算依据),安装于井道上、下端部的非标准长度导轨的支架数量应满足设计要求\nb)  导轨支架应安装牢固，焊接支架的焊缝满足设计要求，锚栓(如膨胀螺栓)固定只能在井道壁的混凝土构件上使用，应无异常开裂或松动', risks: ['I'] , severity: "1,2", probability: "B,C"}
    ]},
    { category: 'A.12 悬挂装置评价内容', items: [
        { id: 'A.12.1', name: '钢丝绳-绳径减小', content: '直径不应小于或等于其公称直径的 90%', risks: ['I'], severity: "1,2", probability: "C" },
        { id: 'A.12.2', name: '钢丝绳-变形或损伤', content: '不应出现笼状畸变、绳股挤出、扭结、部分压扁或弯折', risks: ['I'],  severity: "1,2", probability: "C" },
        { id: 'A.12.3', name: '钢丝绳-锈蚀', content: '不应出现严重锈蚀、铁锈填满绳股间隙', risks: ['I'],severity: "1,2", probability: "C" },
        { id: 'A.12.4', name: '钢丝绳-断丝', content: '钢丝绳外层绳股在一个捻距内断丝总数不应大于以下规定：\na) 当断丝均布在外层绳股上时，6x19、8x19和9x19型钢丝绳在一个捻距内的断丝总数应分别不大于24、30和34根。\nb) 当断丝集中在一根或两根外层绳股上时，6x19、8x19和9x19型钢丝绳在一个捻距内的断丝总数应分别不大于8、10和11根。\nc) 对于任何绳股类型，一根外层绳股上相邻的断丝数量应不大于4根。\nd) 对于任何绳股类型，股谷(缝)的断丝数量应不大于1根。\n注： 上述断丝数的参考长度为一个捻距，约等于6d（d表示钢丝绳的公称直径）。', risks: ['I'], severity: "1,2", probability: "C" },
        { id: 'A.12.5', name: '钢丝绳-表面油污', content: '表面不应有明显油污', risks: ['I', 'Ⅱ'], severity: "1,2,3", probability: "C" },
        { id: 'A.12.6', name: '钢丝绳-张力', content: '应有自动调节装置，任何一根绳的张力与平均值的偏差不大于5%', risks: ['Ⅱ'], severity: "3", probability: "C" },
        { id: 'A.12.7', name: '补偿绳', content: '补偿钢丝绳的绳径减小、变形或损伤、锈蚀、断丝应符合上述钢丝绳相关要求', risks: ['Ⅱ'] , severity: "2,3", probability: "D"},
        { id: 'A.12.8', name: '覆绳(带)-破损', content: '端接装置之间包覆绳(带)不应出现下列情况之一：\na)  包覆层变形(如鼓包、压痕、折痕、凹陷等)\nb)  因包覆层裂纹或磨损导致承载体外露\nc)  包覆层表面有承载体刺出\nd)  承载体断裂', risks: ['I'], severity: "1,2", probability: "C" },
        { id: 'A.12.9', name: '覆绳(带)-直径或厚度减小', content: '包覆绳(带)的实测直径(实测厚度)相对公称直径(公称厚度)不应减少到制造商提供的值', risks: ['I'], severity: "1,2", probability: "C" },
        { id: 'A.12.10', name: '端接装置', content: 'a)  自锁楔形端接装置应安全可靠，其锁紧螺母均应安装有锁紧销，且不应出现下列情况之一：\n   1)  锥套、楔形套、楔块或拉杆出现裂纹\n   2)  楔形套无法锁紧或固定\n   3)  螺纹失效\n   4)  弹簧出现断裂、永久变形或压并圈\n   5)  严重锈蚀\n   6)  复合材料弹性部件老化、开裂\nb)  采用其他类型悬挂装置的，其端部固定应符合制造单位的规定', risks: ['I', 'Ⅱ'] , severity: "1,2", probability: "C,D"}
    ]},
    { category: 'A.13 轿厢评价内容', items: [
        { id: 'A.13.1', name: '轿厢照明、通话、通风和应急照明', content: 'a)  轿厢应设置永久性电气照明装置，确保在控制装置上和在轿厢地板以上1.0 m且距轿壁至少100 mm的任一点的照度不小于100lx。应具有自动再充电紧急电源供电的应急照明，其容量能够确保在下列位置提供至少5lx的照度且持续1h:\n   1)  轿厢内及轿顶上的每个报警触发装置处\n   2)  轿厢中心，地板以上1m处\n   3)  轿顶中心，轿顶以上1m处\n   在正常照明电源发生故障的情况下，应自动接通应急照明电源\nb)  紧急报警装置采用对讲系统以便与救援服务持续联系，当电梯行程大于30 m时，在轿厢和机房(或者紧急操作地点)之间也设置对讲系统，紧急报警装置的供电来自前条所述的紧急电源或者等效电源；在启动对讲系统后，被困乘客不必再做其他操作\nc)  轿厢通风装置(如风扇、空调等)应运转正常', risks: ['I','Ⅱ'] , severity: "1,2", probability: "C,D"},
        { id: 'A.13.2', name: '轿厢有效面积', content: '轿厢的有效面积与额定载重量或乘客人数的关系应符合GB/T 7588.1—2020中5.4.2的要求', risks: ['I','Ⅱ'] , severity: "1,2", probability: "C,D"},
        { id: 'A.13.3', name: '安全窗和安全门', content: '如果轿厢设有安全窗(门),应符合以下要求：\na)  设有手动上锁装置，能够不用钥匙从轿厢外开启，用规定的三角钥匙从轿厢内开启\nb)轿厢安全窗不能向轿厢内开启，并且开启位置不超出轿厢的边缘；轿厢安全门不能向轿厢外开启，并且出入路径没有对重或者固定障碍物\nc)  其锁紧由电气安全装置予以验证', risks: ['I'] , severity: "1,2", probability: "C,D"},
        { id: 'A.13.4', name: '轿顶检修运行控制装置', content: 'a)  轿顶应装设一个易于接近的检修运行控制装置，并符合以下要求：\n   1)  由一个符合电气安全装置要求，能够防止误操作的双稳态开关(检修开关)进行操作\n   2)  一经进入检修运行时，即取消正常运行(包括任何自动门操作)、紧急电动运行，只有再一次操作检修开关，才能使电梯恢复正常工作\n   3)  依靠持续撤压按钮来控制轿厢运行，此按钮有防止误操作的保护，按钮上或其近旁标出相应运行方向\n   4)  该装置上设有一个停止装置，停止装置的操作装置为双稳态、红色并标以"停止"字样，并且有防止误操作的保护\n   5)  检修运行时，安全装置仍然起作用\nb)  轿顶应装设一个从入口处易于接近的停止装置，停止装置的操作装置为双稳态、红色并标以"停止"字样，并且有防止误操作的保护。如果检修运行控制装置设在从入口处易于接近的位置，该停止装置也可以设在检修运行控制装置上\nc)  轿顶应装设2P+PE型250 V,且直接供电的电源插座', risks: ['I'] , severity: "1,2", probability: "C,D"},
        { id: 'A.13.5', name: '通风孔', content: '无孔的轿厢应在上部和下部设置通风孔，有效面积不小于轿厢有效面积的1%,用 一 根直径为10 mm的刚性直棒，不可能从轿厢内经通风孔穿过轿壁', risks: ['I','Ⅱ'] , severity: "2,3", probability: "B,C"},
        { id: 'A.13.6', name: '轿顶护栏', content: '井道壁离轿顶外侧水平方向自由距离超过0.3 m时，轿顶应装设护栏，并且满足以下要求：\na)  由扶手、0.10 m高的踢脚板和位于护栏高度一半处的横杆组成\nb)  当自由距离不大于0.50 m时，扶手高度不小于0.70 m,当自由距离大于0.50 m时，扶手高度不小于1.10 m\nc)  护栏装设在距轿顶边缘最大为0.15 m的位置\nd)  扶手外侧边缘和井道中的任何部件[如对重(或平衡重)、开关、导轨、支架等]之间的水平距离不应小于0.10 m', risks: ['I'] , severity: "1,2", probability: "C,D"},
        { id: 'A.13.7', name: '轿架', content: '轿架不应出现下列情况之一：\na)  轿架变形导致轿底倾斜大于其正常位置5%\nb)  轿架严重变形，导致导靴或安全钳不能正常工作\nc)  轿架出现脱焊或材料开裂，影响电梯安全运行\nd)  轿架严重腐蚀，主要受力构件断面壁厚腐蚀达设计厚度的10%', risks: ['I'] , severity: "1", probability: "B,C"},
        { id: 'A.13.8', name: '轿壁、轿顶和轿底', content: '轿壁、轿顶和轿底不应出现下列情况之一：\na)  轿壁、轿顶严重锈蚀穿孔或破损穿孔，孔的直径大于10 mm\nb)  轿壁、轿顶严重变形或破损，加强筋脱落\nc)  轿壁的强度不符合GB/T 7588.1—2020中5.4.3.2.2的要求\nd)  轿底严重变形、开裂、锈蚀或穿孔\ne)  玻璃轿壁、轿顶出现裂纹\nf)  轿厢吊顶装饰固定不良，存在掉落风险', risks: ['I'] , severity: "1,2", probability: "B,C"},
        { id: 'A.13.9', name: '轿厢护脚板', content: 'a)  轿厢护脚板垂直部分的高度不小于0.75m,宽度不小于对应层站入口的整个净宽度\nb)  护脚板应可靠固定\nc)  护脚板不应严重锈蚀\nd)  护脚板的强度应符合GB/T 7588.1—2020中5.4.5.3的要求', risks: ['I'] , severity: "1,2", probability: "B,C"},
        { id: 'A.13.10', name: '按钮', content: '轿内与层站按钮设置合理、完整可靠', risks: ['Ⅱ'] , severity: "3", probability: "D"}
    ]},
    { category: 'A.14 底坑评价内容', items: [
        { id: 'A.14.1', name: '底坑爬梯', content: '如果没有其他通道，为了方便检修人员安全地进入底坑，应在底坑内设置一个易于作业人员从层门进入底坑的永久性装置，此装置不应凸入电梯的运行空间', risks: ['Ⅱ'] , severity: "2", probability: "D"},
        { id: 'A.14.2', name: '缓冲器固定', content: '缓冲器应固定可靠、无明显倾斜', risks: ['I'] , severity: "2", probability: "B,C"},
        { id: 'A.14.3', name: '线性缓冲器(弹簧缓冲器)', content: '线性缓冲器(弹簧缓冲器)不应出现下列情况之一：\na)  弹簧严重锈蚀或出现裂纹\nb)  缓冲器动作后，有影响正常工作的永久变形或损坏', risks: ['I'] , severity: "2", probability: "B,C"},
        { id: 'A.14.4', name: '非线性缓冲器', content: '非线性缓冲器不应出现下列情况之一：\na)  非金属材料出现开裂、剥落等老化现象\nb)  缓冲器动作后，有影响正常工作的永久变形或损坏', risks: ['I'] , severity: "2", probability: "B,C"},
        { id: 'A.14.5', name: '耗能型缓冲器(液压缓冲器)', content: '耗能型缓冲器(液压缓冲器)液位应正确，便于检查，且有验证柱塞复位的电气安全装置，且不应出现下列情况之一：\na)  缸体有裂纹\nb)  漏油，不能保证正常的工作液面高度\nc)  柱塞锈蚀，影响正常工作\nd)  复位弹簧失效，缓冲器复位不符合GB/T 7588.2—2020中5.5.3.1.6.2的要求\ne)  缓冲器动作后，有影响正常工作的永久变形或损坏', risks: ['I'] , severity: "2", probability: "B,C"},
        { id: 'A.14.6', name: '停止装置、照明、检修运行控制装置', content: 'a)  底坑内应设置在进入底坑时和底坑地面上均能方便操作的停止装置，停止装置的操作装置为双稳态、红色并标以"停止"字样，并且有防止误操作的保护\nb)  底坑内应设置2P+PE型250 V,且直接供电的电源插座，以及在进入底坑时能方便操作的井道照明开关，底坑照明应符合GB/T 7588.1—2020中5.2.1.4.1和5.2.1.5.1的要求\nc)  底坑检修运行控制装置应有效', risks: ['I'] , severity: "1,2", probability: "C,D"},
        { id: 'A.14.7', name: '井道下方空间的防护', content: '如果井道下方确有人员能够到达的空间，对重(或平衡重)上应设置安全钳', risks: ['Ⅱ'] , severity: "1", probability: "E"},
        { id: 'A.14.8', name: '限速器绳、补偿绳张紧装置', content: '张紧装置应有验证其位置的电气安全装置，张紧装置不应出现下列情况：\na)  张紧轮变形或开裂\nb)  张紧轮轴承损坏\nc)  张紧轮绳槽缺损或严重磨损\nd)  张紧装置的机械结构严重变形\ne)  张紧轮轴承座外圈磨损或轴磨损', risks: ['Ⅱ'] , severity: "2", probability: "D"},
        { id: 'A.14.9', name: '底坑环境', content: '底坑地面应平整，不应有积水、油污和杂物', risks: ['I','Ⅱ'] , severity: "2,3", probability: "C,D"}
    ]},
    { category: 'A.15 液压部件评价内容', items: [
        { id: 'A.15.1', name: '溢流阀', content: '在连接到液压泵和单向阀之间的油路上应设置溢流阀，溢流阀的调定压力不超过满载压力的140%,必要时考虑损耗，压力不超过满载压力的170%', risks: ['I'] , severity: "1", probability: "B,C"},
        { id: 'A.15.2', name: '紧急下降阀', content: '机房内手动操作的紧急下降阀功能可靠', risks: ['Ⅱ'] , severity: "3", probability: "C,D"},
        { id: 'A.15.3', name: '手动泵', content: '对于轿厢上装有安全钳或者夹紧装置的液压电梯，应具有能使轿厢向上移动的手动泵，手动泵应连接到单向阀或下行方向阀与截止阀之间的油路上。手动泵应设置溢流阀，溢流阀的调定压力不超过满载压力的2.3倍', risks: ['Ⅱ'] , severity: "3", probability: "D"},
        { id: 'A.15.4', name: '截止阀', content: '在将液压缸连接到单向阀和下行方向阀的油路上应设置截止阀，其功能应有效', risks: ['I','Ⅱ'] , severity: "2,3", probability: "C,D"},
        { id: 'A.15.5', name: '破裂阀', content: '破裂阀(如果有)应完好，功能正常，无锈蚀、漏油现象', risks: ['I'] , severity: "1", probability: "B,C"},
        { id: 'A.15.6', name: '液压缸', content: '液压缸应密封良好，不应出现下列现象：\na) 柱塞严重锈蚀、磨损或损伤导致漏油\nb) 柱塞受外力导致变形\nc) 缸筒严重锈蚀或变形\nd) 对接式柱塞连接失效\ne) 对接式缸筒连接失效\nf)  缓冲制停失效\ng) 多级式液压缸内置液压同步机构失效', risks: ['I'] , severity: "1,2", probability: "C"},
        { id: 'A.15.7', name: '液压管路', content: 'a)  液压硬管不应出现严重腐蚀、变形或漏油，管接头应完好，无漏油\nb)  液压软管表面不应出现破损、老化、开裂现象，钢丝编织层应完好无破损，管接头应完好无漏油\nc)  液压管路及其附件应可靠固定并且便于检查，软管固定时，其弯曲半径不应小于制造单位标明的弯曲半径', risks: ['Ⅱ'] , severity: "3", probability: "C,D"},
        { id: 'A.15.8', name: '其他液压元件', content: '其他液压元件(油箱、阀组、滤油器、潜油泵等)应功能正常，密封良好，无锈蚀、变形、破损、开裂、过度磨损、堵塞、漏油现象', risks: ['Ⅱ'] , severity: "3", probability: "C,D"},
        { id: 'A.15.9', name: '液压油', content: '液压油不应出现进水、浑浊、乳化或因高温氧化导致油液发黑、油泥析出等现象', risks: ['Ⅱ'] , severity: "3", probability: "D"},
        { id: 'A.15.10', name: '油温监控装置', content: '液压系统油温监控装置功能应可靠有效', risks: ['Ⅱ'] , severity: "3", probability: "C"}
    ]},
    { category: 'A.16 电气控制系统评价内容', items: [
        { id: 'A.16.1', name: '控制柜', content: '控制柜不应出现下列情况之一：\na)  控制柜柜体严重锈蚀变形、损坏，导致柜内元器件无法固定和正常使用\nb)  控制柜内电气元件失效导致电梯不能正常运行，无法更换为同规格参数的元件，或更换替代元件后仍无法正常运行\nc)  接线不规范不合理、标识混乱、接线柱松动\nd)  控制柜防护等级低于IP2X\n注：包含能量回馈装置、自动救援操作装置、群控柜、轿厢控制部分。', risks: ['I'] , severity: "1,2", probability: "B,C"},
        { id: 'A.16.2', name: '可编程控制器(PLC)', content: '可编程控制器(PLC)不应出现下列情况之一：\na)  外壳破损存在触电危险\nb)  主要单元、模块失效\n注：不包括含有电子元件的安全电路和电梯安全相关的可编程电子系统(PESSRAL)。', risks: ['I','Ⅱ'] , severity: "1,2", probability: "D"},
        { id: 'A.16.3', name: '变频器', content: '变频器不应出现下列情况之一：\na)  外壳破损存在触电危险\nb)  输入输出主回路电路板铜皮断裂\nc)  直流母线电容鼓包、漏液或明显烧坏\nd)  输入或输出、制动单元及制动电阻的接线端子和铜排出现严重的过热变形、拉弧氧化或腐蚀\ne)  变频器与电动机功率不匹配，工作温度不正常，有异响', risks: ['I','Ⅱ'] , severity: "1,2", probability: "C,D"},
        { id: 'A.16.4', name: '相序保护装置', content: '应具有断相、错相保护功能；电梯运行与相序无关时，可以不装设错相保护装置', risks: ['Ⅱ'] , severity: "3", probability: "C"},
        { id: 'A.16.5', name: '接触器、接触器式继电器和继电器', content: '接触器、接触器式继电器和继电器应符合以下要求：\na)  主接触器(使驱动主机停止运转的接触器)符合GB/T14048.4—2020的规定，并根据相应的使用类型选择；按照GB/T14048.5—2017的附录L,主接触器的辅助触点是机械联锁触头元件\nb)  接触器式继电器符合GB/T14048.5—2017的附录L,如果使用接触器式继电器操作主接触器，则接触器式继电器应符合GB/T 14048.5—2017的规定。如果使用继电器操作主接触器，则继电器应符合GB/T 21711.1—2008的规定。它们应按照下列使用类型进行选择：\n   1)  AC-15,用于控制交流接触器\n   2)  DC-13,用于控制直流接触器\nc)  继电器符合IEC 61810-3,以便确保任何动合触点和任何动断触点不能同时在闭合位置\nd)  当切断或接通线圈电路时，接触器能正确、可靠地断开或闭合\ne)  接触器、继电器触点没有严重磨损或锈蚀\nf)  接触器(继电器)工作时没有异常噪声', risks: ['I'] , severity: "1,2", probability: "B,C"},
        { id: 'A.16.6', name: '安全开关', content: '安全开关不应出现下列情况之一：\na)  安全开关的外壳破损，存在触电危险\nb)  安全开关触点严重锈蚀，影响正常运行\nc)  安全开关触点严重烧灼或接触不良\nd)  触发安全开关的机械装置失效\ne)  驱动安全触点的结构失效\nf)  被短接', risks: ['I','Ⅱ'] , severity: "1,2", probability: "C,D"},
        { id: 'A.16.7', name: '传感器和检测开关', content: '传感器或检测开关不应出现下列情况之一：\na)  输出信号异常，引起功能失效或误动作\nb)  外壳严重破损或变形', risks: ['Ⅱ'] , severity: "3", probability: "C"},
        { id: 'A.16.8', name: '导线和电缆', content: '导线和电缆不应出现下列情况之一：\na)  护套出现开裂，导致导线外露\nb)绝缘材料发生破损、老化，导致导体外露或绝缘电阻不符合GB/T 7588.1—2020中5.10.1.3.1的要求\nc)  导线发生断裂或短路', risks: ['I','Ⅱ'] , severity: "1,2", probability: "C,D"},
        { id: 'A.16.9', name: '印制电路板', content: '印制电路板不应出现下列情况之一：\na)  受潮进水，被酸碱等严重腐蚀，铜箔拉弧氧化、元件焊盘受损或脱落等，导致功能失效\nb)  外力折裂\nc)  严重烧毁碳化', risks: ['Ⅱ'] , severity: "2", probability: "D"},
        { id: 'A.16.10', name: '断开使电动机运转的供电的电气安全装置', content: '断开使电动机运转的供电的电气安全装置应符合GB/T 7588.1—2020中5.9.2.5.2～5.9.2.5.4的要求', risks: ['I','Ⅱ'] , severity: "1,2", probability: "C,D"},
        { id: 'A.16.11', name: '层门和轿门旁路装置', content: '层门和轿门旁路装置应符合GB/T 7588.1—2020中5.12.1.8的要求', risks: ['I'] , severity: "1", probability: "D"},
        { id: 'A.16.12', name: '门回路监测功能', content: '门触点故障时应防止电梯正常运行，即应符合GB/T 7588.1—2020中5.12.1.9的要求', risks: ['I'] , severity: "1", probability: "D"},
        { id: 'A.16.13', name: '电动机运转时间限制器', content: '电动机运转时间限制器的设置和性能应符合GB/T 7588.1—2020中5.9.2.7的要求', risks: ['I','Ⅱ'] , severity: "1,2", probability: "C,D"}
    ]},
    { category: 'A.17 功能试验评价内容', items: [
        { id: 'A.17.1', name: '平衡系数试验', content: '应在0.40～0.50之间，或者符合制造(改造)单位的设计要求', risks: ['I'] , severity: 1, probability: "B"},
        { id: 'A.17.2', name: '轿厢上行超速保护装置试验', content: '当轿厢上行速度失控时，轿厢上行超速保护装置应动作，使轿厢制停或者至少使其速度降低至对重缓冲器的设计范围；该装置动作时，应使一个电气安全装置动作', risks: ['I'] , severity: 1, probability: "C,D"},
        { id: 'A.17.3', name: '轿厢意外移动保护装置试验', content: 'a)  轿厢在井道上部空载，以型式试验证书所给出的试验速度上行并触发制停部件，仅使用制停部件能够使电梯停止，轿厢的移动距离在型式试验证书给出的范围内\nb)  如果电梯采用内部冗余的驱动主机制动器作为制停部件，则当制动器机械装置提起(或者释放)失效，或者制动力不足时，应关闭轿门和层门，并且防止电梯的正常启动', risks: ['I'] , severity: 1, probability: "C,D"},
        { id: 'A.17.4', name: '限速器-安全钳(包括轿厢和对重或平衡重)联动试验', content: '轿厢空载，以检修速度进行限速器一安全钳联动试验，限速器、安全钳动作应可靠', risks: ['I'] , severity: "1", probability: "C,D"},
        { id: 'A.17.5', name: '运行试验', content: 'a)  轿厢分别空载、满载，以正常运行速度上、下运行，呼梯、楼层显示等信号系统功能有效、指示正确、动作无误，轿厢平层良好，无异常现象发生\nb)  对于设有IC卡系统的电梯，轿厢内的人员无需通过IC卡系统即可到达建筑物的出口层，并且在电梯退出正常服务时，自动退出IC卡功能', risks: ['I','Ⅱ'] , severity: "2,3", probability: "C,D"},
        { id: 'A.17.6', name: '应急救援试验', content: 'a)  在机房内或者紧急操作和动态测试装置上设有明晰的应急救援程序，所有救援工具齐全\nb)  建筑物内的救援通道保持通畅，以便相关人员无阻碍地抵达实施紧急操作的位置和层站等处\nc)  在各种载荷工况下，按照本条a)所述的应急救援程序实施操作，能够安全、及时地解救被困人员', risks: ['I','Ⅱ'] , severity: "2,3", probability: "C,D"},
        { id: 'A.17.7', name: '电梯速度', content: 'a)  对于曳引电梯：当电源为额定频率，电动机施以额定电压时，轿厢装载50%额定载重量，向下运行至行程中段(除去加速和减速段)时的速度，不应大于额定速度的105%,不宜小于额定速度的92%\nb)  对于液压电梯：空载轿厢上行的速度不应超过上行额定速度的8%,载有额定载重量的轿厢下行速度不应超过下行额定速度的8%', risks: ['I','Ⅱ'] , severity: "2,3", probability: "B"},
        { id: 'A.17.8', name: '空载曳引检查', content: '当对重压在缓冲器上而曳引机按电梯上行方向旋转时，应不能提升空载轿厢至危险位置', risks: ['I'] , severity: 1, probability: "B,C"},
        { id: 'A.17.9', name: '上行制动工况曳引检查', content: '轿厢空载以正常运行速度上行至行程上部，切断电动机与制动器供电，轿厢应完全停止', risks: ['I'] , severity: 1, probability: "B,C"},
        { id: 'A.17.10', name: '下行制动工况曳引检查', content: '轿厢装载125%额定载重量，以正常运行速度下行至行程下部，切断电动机与制动器供电，轿厢应完全停止', risks: ['I'] , severity: 1, probability: "B,C"},
        { id: 'A.17.11', name: '制动试验', content: '轿厢装载125%额定载重量，以正常运行速度下行时，切断电动机和制动器供电，制动器应能够使驱动主机停止运转且轿厢应完全停止，试验后轿厢应无明显变形和损坏\n注 ："制动试验"可以与"下行制动工况曳引检查"一并试验。', risks: ['I'] , severity: 1, probability: "B"},
        { id: 'A.17.12', name: '静态曳引检查', content: 'a)  对于轿厢面积超过规定的载货电梯，以轿厢实际面积所对应的125%额定载重量进行静态曳引试验，历时10 min,曳引绳应没有打滑现象\nb)  对于额定载重量按照单位轿厢有效面积不小于200 kg/m²计算的非商用汽车电梯，以150%额定载重量做静态曳引试验，历时10 min,曳引绳应没有打滑现象', risks: ['I'] , severity: 1, probability: "B,C"},
        { id: 'A.17.13', name: '超载保护', content: '超载保护装置在载荷超过额定载重量时，能够发出警示信号，最迟在轿厢内的载荷达到110%额定载重量(如额定载重量不大于750 kg,最大超载量取75 kg)时，应能够防止电梯正常启动及再平层，并且轿厢内有音响或者发光信号提示，动力驱动的自动门完全打开，手动门保持在未锁状态\n在轿厢装载未达到额定重量时，超载保护装置应不能动作，轿厢能够正常启动', risks: ['I','Ⅱ'] , severity: 1, probability: "B,C"},
        { id: 'A.17.14', name: '沉降试验', content: '装有额定载重量的轿厢停在上端站，10 min内的下沉距离应不超过10 mm', risks: ['Ⅱ'] , severity: "3", probability: "C,D"},
        { id: 'A.17.15', name: '破裂阀动作试验', content: '轿厢装有额定载重量下行，当达到破裂阀的动作速度时，轿厢应能够被可靠制停', risks: ['I'] , severity: 1, probability: "B,C"},
        { id: 'A.17.16', name: '其他类防止轿厢坠落措施试验', content: '采用除破裂阀或者限速器-安全钳联动以外的防止轿厢坠落、超速下降措施，参照17.4和17.15的载荷要求进行试验\n注 ：其试验方法应当由制造单位在其附近明显标识。', risks: ['I'] , severity: 1, probability: "B,C"},
        { id: 'A.17.17', name: '液压泵站组合阀性能试验', content: '关闭截止阀，使用手动泵使系统压力达到满载压力值，3 min时系统压力下降值不应超过使用说明书给出的规定值', risks: ['Ⅱ'] , severity: "3", probability: "C,D"}
    ]},
    { category: 'A.18 乘运质量评价内容', items: [
        { id: 'A.18.1', name: '运行噪声', content: '按照GB/T10059—2009中4.2.5规定方法所测得的乘客电梯运行中轿厢内噪声，开关门过程噪声和机房噪声应符合GB/T 10058—2009中3.3.6的要求', risks: ['Ⅱ'] , severity: "4", probability: "B"},
        { id: 'A.18.2', name: '启动加速度、制停减速度', content: 'a)  乘客电梯起动加速度和制动减速度最大值不应大于1.5m/s²\nb)  当乘客电梯额定速度为大于1.0 m/s并不大于2.0 m/s时，按GB/T24474.1—2020中5.2.3测量，A95加、减速度不应小于0.5 m/s²\nc)  当乘客电梯额定速度为大于2.0 m/s并不大于6.0 m/s时，按GB/T 24474.1—2020中5.2.3测量，A95加、减速度不应小于0.7 m/s²', risks: ['Ⅱ'] , severity: "4", probability: "B"},
        { id: 'A.18.3', name: '轿厢最大水平振动', content: '乘客电梯轿厢运行期间水平振动的最大峰峰值不应大于0.20 m/s²,A95峰峰值不应大于0.15m/s²', risks: ['Ⅱ'] , severity: "4", probability: "B"},
        { id: 'A.18.4', name: '轿厢最大垂直振动', content: '乘客电梯轿厢运行在恒加速度区域内的垂直振动的最大峰峰值不应大于0 . 30 m/s²,A95峰峰值不应大于0.20  m/s²', risks: ['Ⅱ'] , severity: "4", probability: "B"},
        { id: 'A.18.5', name: '开关门时间', content: '乘客电梯开关门时间应符合GB/T 10058—2009中3.3.4的要求。对开门宽度超过1300 mm的乘客电梯，应符合电梯制造单位给出的限值指标。制造单位没有给出限值指标时，按照开门宽度为1300 mm的电梯限值指标来判定', risks: ['Ⅱ'] , severity: "4", probability: "A"},
        { id: 'A.18.6', name: '故障和困人情况', content: '评估前6个月内平均每个月的故障停梯和困人情况', risks: ['I','Ⅱ'] , severity: "1,2,3,4", probability: "A,B,C,D,E,F"}
    ]},
    { category: 'B.1 建筑相关评价内容', items: [
        { id: 'B.1.1', name: '机器空间和滑轮间及通道', content: 'a)  为了维护和救援，通道(例如：通往底坑、层站、机器空间和滑轮间的通道)不应经过私人空间\nb)  通道应设置永久性电气照明\nc)  机房通道门的宽度应不小于0.60 m,高度应不小于1.80 m,并且门不应向机房内开启；门应装有带钥匙的锁，并且可以从机房内不用钥匙打开', risks: ['Ⅱ'], severity: "3", probability: "C,D" },
        { id: 'B.1.2', name: '温度控制和通风', content: 'a)  机房中的环境温度应保持在+5℃~+40 ℃\nb)  机房应有适当的通风，同时考虑井道可能通过机房通风。从建筑物其他处抽出的陈腐空气不应直接排入机房内；应保护诸如电动机、设备以及电缆等，使它们尽可能不受灰尘、有害气体和湿气的损害', risks: ['I','Ⅱ'] , severity: "3", probability: "C,D" },
        { id: 'B.1.3', name: '顶层间距', content: '顶层空间应符合GB/T 7588.1—2020中5.2.5.6和5.2.5.7的要求', risks: ['I','Ⅱ'] , severity: "1,2", probability: "C,D" },
        { id: 'B.1.4', name: '底坑工作区域和避险空间', content: '底坑空间应符合GB/T 7588.1—2020中5.2.5.8的要求', risks: ['I','Ⅱ'] , severity: "1,2", probability: "C,D"},
        { id: 'B.1.5', name: '井道封闭与防护', content: '除必要的开口外井道应完全封闭。当建筑物中不要求井道在火灾情况下具有防止火焰蔓延的功能时，允许采用部分封闭井道，但在人员可正常接近电梯处应设置无孔的高度足够的围壁，以防止人员遭受电梯运动部件直接危害，或者用手持物体触及井道中的电梯设备',risks: ['I','Ⅱ'] , severity: "1", probability: "C,D" },
        { id: 'B.1.6', name: '金属支架或吊钩', content: '在机器空间以及在井道顶端(如果有必要)的适当位置应设置具有安全工作负荷标志的一个或多个悬挂点，用于较重设备的吊装', risks: ['I','Ⅱ'] , severity: "1,2", probability: "C,D"},
        { id: 'B.1.7', name: '消防设施', content: '如机房设置消防设施，应符合GB/T 7588.1—2020中5.2.1.2.1的要求',  risks: ['I','Ⅱ'] , severity: "2,3", probability: "D" }
    ]}
];

const checklistData = [
    { category: 'C.1 使用管理评价内容', items: [
        { id: 'C.1.1', name: '检验检测', content: '按照相关法律法规要求进行检验检测', risks: ['I','Ⅱ'] , severity: "1,2,3,4", probability: "A,B,C,D,E,F" },
        { id: 'C.1.2', name: '维保合同', content: '使用单位应委托取得相应电梯安装(含维修)许可子项目的单位进行电梯维保，并签订有效维保合同', risks: ['I','Ⅱ'] , severity: "1,2,3,4", probability: "A,B,C,D,E,F" },
        { id: 'C.1.3', name: '机构设置和人员配置', content: '设置电梯的安全管理机构或者配备电梯安全管理人员', risks: ['I','Ⅱ'] , severity: "1,2,3,4", probability: "A,B,C,D,E,F" },
        { id: 'C.1.4', name: '管理制度建立和落实', content: '应建立岗位责任、隐患治理、应急救援等安全管理制度，制定操作规程，并得到有效落实' , risks: ['I','Ⅱ'] , severity: "1,2,3,4", probability: "A,B,C,D,E,F"},
        { id: 'C.1.5', name: '人员履职', content: '电梯安全管理人员应对电梯使用状况进行经常性检查，发现问题应立即处理；情况紧急时，可以决定停止使用电梯并及时报告本单位有关负责人', risks: ['I','Ⅱ'] , severity: "1,2,3,4", probability: "A,B,C,D,E,F" },
        { id: 'C.1.6', name: '安全技术档案', content: '应建立电梯安全技术档案并保持完好，安全技术档案应包括以下内容：产品质量合格证明、安装及使用维护保养说明、监督检验和定期检验报告、检测报告(如有)、日常检查与使用状况记录、维护保养记录、年度自行检查记录或者报告、应急救援演习记录、运行故障和事故记录等', risks: ['I','Ⅱ'] , severity: "1,2,3,4", probability: "A,B,C,D,E,F" },
        { id: 'C.1.7', name: '运行状况', content: '应有设备运行记录，设备的运行状况应良好' , risks: ['I','Ⅱ'] , severity: "1,2,3,4", probability: "A,B,C,D,E,F"}
    ]},
    { category: 'D.1 日常维护保养评价内容', items: [
        { id: 'D.1.1', name: '维保资质', content: '电梯维护保养单位应具有相应的资质，而且在有效期内', risks: ['I','Ⅱ'] , severity: "1,2,3,4", probability: "A,B,C,D,E,F" },
        { id: 'D.1.2', name: '维保人员', content: '维保单位应对作业人员进行安全教育和培训，维保人员应具有电梯修理项目的"特种设备作业人员证",并在有效期内', risks: ['I','Ⅱ'] , severity: "1,2,3,4", probability: "A,B,C,D,E,F" },
        { id: 'D.1.3', name: '维保履职', content: '接受全面检查，没有安全隐患：\na)  严格按照安全技术规范的要求和维保方案实施电梯维保，维保期间落实现场安全防护措施，保证施工安全\nb)  设立24 h维保值班电话\nc)  对电梯发生的故障等情况，及时进行详细的记录\nd)  建立每台电梯的维保记录\ne)  协助电梯使用单位制定电梯安全管理制度和应急救援预案', risks: ['I','Ⅱ'] , severity: "1,2,3,4", probability: "A,B,C,D,E,F" },
        { id: 'D.1.4', name: '自检情况', content: 'a)  每年度至少进行一次自行检查\nb)  自行检查项目及其内容根据使用状况确定，并且向使用单位出具有自行检查和审核人员签字、加盖维保单位公章或者其他专用章的自行检查记录或者报告', risks: ['I','Ⅱ'] , severity: "1,2,3,4", probability: "A,B,C,D,E,F" },
        { id: 'D.1.5', name: '部件更换', content: 'a)  部件更换应有记录\nb)  更换的电梯主要零部件具有产品质量证明文件，主要部件和安全保护装置具有型式试验证书', risks: ['I','Ⅱ'] , severity: "1,2,3,4", probability: "A,B,C,D,E,F" },
        { id: 'D.1.6', name: '用户评价', content: '使用单位对维保服务质量评价良好', risks: ['I','Ⅱ'] , severity: "1,2,3,4", probability: "A,B,C,D,E,F" }
    ]}
];

document.addEventListener('DOMContentLoaded', () => {
    const form = document.getElementById('evaluation-form');
    const checklistContainer = document.getElementById('management-checklist');

    // --- Mobile Optimizations (No changes needed here) ---
    let lastTouchEnd = 0;
    document.addEventListener('touchend', function (event) {
        const now = (new Date()).getTime();
        if (now - lastTouchEnd <= 300) {
            event.preventDefault();
        }
        lastTouchEnd = now;
    }, false);

    // --- Generate Evaluation Form ---
    function generateItems(data, container) {
        data.forEach(cat => {
            const categoryWrapper = document.createElement('div');
            categoryWrapper.className = 'category-wrapper';

            const categoryHeader = document.createElement('h2');
            categoryHeader.textContent = cat.category;
            categoryHeader.className = 'category-header';
            categoryWrapper.appendChild(categoryHeader);

            const itemsContainer = document.createElement('div');
            itemsContainer.className = 'category-items';

            cat.items.forEach(item => {
                const itemDiv = document.createElement('div');
                itemDiv.className = 'item';
                itemDiv.id = `item-${item.id}`;

                const riskCount = item.risks ? item.risks.length : 2; // Default to 2 for C/D items

                
                // 根据项目自身的severity和probability属性生成严重程度和概率等级选项
                let severityOptions = '';
                let probabilityOptions = '';
                
                // 根据severity属性生成严重程度选项
                if (item.severity) {
                    if (typeof item.severity === 'string') {
                        // 如果是字符串，按逗号分割
                        const severityLevels = item.severity.split(',').map(s => s.trim());
                        severityOptions = severityLevels.map(level => 
                            `<label><input type="radio" name="severity-${item.id}" value="${level}" required> ${level}级</label>`
                        ).join('');
                    } else if (typeof item.severity === 'number') {
                        // 如果是数字，直接使用
                        severityOptions = `<label><input type="radio" name="severity-${item.id}" value="${item.severity}" required> ${item.severity}级</label>`;
                    }
                } else {
                    // 默认有2级和3级严重程度
                    severityOptions = '<label><input type="radio" name="severity-' + item.id + '" value="2" required> 2级</label>' +
                                     '<label><input type="radio" name="severity-' + item.id + '" value="3" required> 3级</label>';
                }
                
                // 根据probability属性生成概率等级选项
                if (item.probability) {
                    if (typeof item.probability === 'string') {
                        // 如果是字符串，按逗号分割
                        const probabilityLevels = item.probability.split(',').map(p => p.trim());
                        probabilityOptions = probabilityLevels.map(level => 
                            `<label><input type="radio" name="probability-${item.id}" value="${level}" required> ${level}级</label>`
                        ).join('');
                    } else if (typeof item.probability === 'number') {
                        // 如果是数字，直接使用
                        probabilityOptions = `<label><input type="radio" name="probability-${item.id}" value="${item.probability}" required> ${item.probability}级</label>`;
                    }
                } else {
                    // 默认有C级和D级概率
                    probabilityOptions = '<label><input type="radio" name="probability-' + item.id + '" value="C" required> C级</label>' +
                                        '<label><input type="radio" name="probability-' + item.id + '" value="D" required> D级</label>';
                }
                
                // 所有项目都显示严重程度和概率等级选项
                let riskOptionsHtml = `
                    <div class="risk-assessment-section">
                        <div class="severity-section">
                            <strong>严重程度:</strong><br>
                            ${severityOptions}
                        </div>
                        <div class="probability-section">
                            <strong>概率等级:</strong><br>
                            ${probabilityOptions}
                        </div>
                    </div>
                `;

                // ***MODIFICATION 1: Add classes to labels for better styling***
                let statusOptionsHtml = `
                    <label class="status-compliant"><input type="radio" name="status-${item.id}" value="compliant"> 符合</label>
                    <label class="status-non-compliant"><input type="radio" name="status-${item.id}" value="non-compliant"> 不符合</label>
                    <label class="status-not-applicable"><input type="radio" name="status-${item.id}" value="not-applicable"> 无此项</label>
                `;

                // 为移动端创建可折叠的结构
                itemDiv.innerHTML = `
                    <div class="item-header">${item.id} ${item.name}</div>
                    <div class="item-collapsible-content collapsed">
                        <div class="item-content">${item.content.replace(/\n/g, '<br>')}</div>
                        <div class="item-options">
                            ${statusOptionsHtml}
                        </div>
                        <div class="risk-category-options" id="risk-options-${item.id}" data-risk-count="${riskCount}">
                            ${riskOptionsHtml}
                            <div class="current-risk-display" id="current-risk-${item.id}" style="display:none">
                                <span class="risk-item-category" id="risk-badge-${item.id}"></span>
                            </div>
                        </div>
                    </div>
                `;
                itemsContainer.appendChild(itemDiv);

                // --- Default selection logic ---
                const isA15 = cat.category.startsWith('A.15');
                const isChecklist = cat.category.startsWith('C.') || cat.category.startsWith('D.');

                // ***MODIFICATION 2: Add 'selected' class on initial load***
                if (isA15) {
                    const radio = itemDiv.querySelector('input[value="not-applicable"]');
                    radio.checked = true;
                    radio.parentElement.classList.add('selected');
                } else if (isChecklist) {
                     const radio = itemDiv.querySelector('input[value="not-applicable"]');
                    radio.checked = true;
                    radio.parentElement.classList.add('selected');
                }
                else {
                    const radio = itemDiv.querySelector('input[value="compliant"]');
                    radio.checked = true;
                    radio.parentElement.classList.add('selected');
                }
            });
            categoryWrapper.appendChild(itemsContainer);
            container.appendChild(categoryWrapper);
        });
    }

    generateItems(evaluationData, form);
    generateItems(checklistData, checklistContainer);
    
    // 页面加载后的初始化逻辑
    setTimeout(() => {
        initializePage();
        // 检测严重程度和概率等级选项数量并添加相应的CSS类
        detectSeverityOptions();
    }, 100);


    // --- Event Listeners ---
    // Item collapse toggle
    document.addEventListener('click', function(e) {
        if (e.target.classList.contains('item-header')) {
            const collapsibleDiv = e.target.nextElementSibling;
            if (collapsibleDiv && collapsibleDiv.classList.contains('item-collapsible-content')) {
                collapsibleDiv.classList.toggle('collapsed');
                e.target.classList.toggle('collapsed');
            }
        }
    });
    
    // Category collapse toggle
    document.addEventListener('click', (e) => {
        if (e.target.classList.contains('category-header')) {
            const itemsContainer = e.target.nextElementSibling;
            if(itemsContainer) {
                const wrapper = e.target.closest('.category-wrapper');
                itemsContainer.style.display = itemsContainer.style.display === 'none' ? '' : 'none';
                wrapper.classList.toggle('collapsed');
            }
        }
    });

    // Radio button change handler
    function handleRadioChange(e) {
        if (e.target.type === 'radio' && e.target.name.startsWith('status-')) {
            const itemId = e.target.name.replace('status-', '');
            handleRiskOptionsDisplay(itemId, e.target.value);
            
            // ***MODIFICATION 3: Add/Remove 'selected' class on change***
            const itemOptionsDiv = e.target.closest('.item-options');
            if (itemOptionsDiv) {
                itemOptionsDiv.querySelectorAll('label').forEach(label => {
                    label.classList.remove('selected');
                });
                e.target.parentElement.classList.add('selected');
            }
            
            // 检查是否需要自动折叠类别
            checkCategoryAutoCollapse();
        }
    }
    
    // 页面初始化
    function initializePage() {
        // 1. 初始化所有风险类别选择框为隐藏状态
        initializeRiskOptions();
        // 2. 初始化类别折叠状态
        initializeCategoryCollapse();
        // 3. 绑定严重程度/概率变化，实时更新风险类别
        document.querySelectorAll('.severity-section input[type="radio"]').forEach(r => {
            r.addEventListener('change', (e) => {
                // 切换选中态样式
                const section = e.target.closest('.severity-section');
                if (section) section.querySelectorAll('label').forEach(l => l.classList.remove('selected'));
                e.target.parentElement.classList.add('selected');
                // 更新风险显示
                const name = e.target.name; // severity-<id>
                const itemId = name.replace('severity-','');
                updateItemRiskDisplay(itemId);
            });
        });
        document.querySelectorAll('.probability-section input[type="radio"]').forEach(r => {
            r.addEventListener('change', (e) => {
                // 切换选中态样式
                const section = e.target.closest('.probability-section');
                if (section) section.querySelectorAll('label').forEach(l => l.classList.remove('selected'));
                e.target.parentElement.classList.add('selected');
                // 更新风险显示
                const name = e.target.name; // probability-<id>
                const itemId = name.replace('probability-','');
                updateItemRiskDisplay(itemId);
            });
        });
        // 初始化已选中的高亮
        document.querySelectorAll('.severity-section input[type="radio"]:checked, .probability-section input[type="radio"]:checked')
            .forEach(r => r.parentElement.classList.add('selected'));
    }
    
    // 初始化风险类别选择框
    function initializeRiskOptions() {
        // 确保所有风险类别选择框都是隐藏的
        const allRiskOptions = document.querySelectorAll('.risk-category-options');
        allRiskOptions.forEach(riskOption => {
            riskOption.classList.remove('show');
            // 清除任何已选中的风险类别
            riskOption.querySelectorAll('input[type="radio"]').forEach(radio => {
                radio.checked = false;
            });
        });
        
        // 对已选择状态的项目调用显示逻辑
        const allStatusRadios = document.querySelectorAll('input[name^="status-"]:checked');
        allStatusRadios.forEach(radio => {
            const itemId = radio.name.replace('status-', '');
            handleRiskOptionsDisplay(itemId, radio.value);
        });
    }
    
    // 初始化页面折叠状态
    function initializeCategoryCollapse() {
        const isMobile = window.innerWidth <= 768;
        const categoryWrappers = document.querySelectorAll('.category-wrapper');
        
        if (isMobile) {
            // 手机端：默认折叠所有大项目
            categoryWrappers.forEach(wrapper => {
                const categoryItems = wrapper.querySelector('.category-items');
                if (categoryItems) {
                    categoryItems.style.display = 'none';
                    wrapper.classList.add('collapsed');
                }
            });
        } else {
            // 电脑端：只折叠全"无此项"的大项目
            checkDesktopCategoryAutoCollapse();
        }
    }
    
    // 检查类别是否需要自动折叠（用于选项变更时）
    function checkCategoryAutoCollapse() {
        const isMobile = window.innerWidth <= 768;
        
        if (isMobile) {
            // 移动端在选项变更时的折叠逻辑
            checkMobileCategoryAutoCollapse();
        } else {
            // 桌面端的折叠逻辑
            checkDesktopCategoryAutoCollapse();
        }
    }
    
    // 移动端类别自动折叠检查
    function checkMobileCategoryAutoCollapse() {
        const categoryWrappers = document.querySelectorAll('.category-wrapper');
        categoryWrappers.forEach(wrapper => {
            const items = wrapper.querySelectorAll('.item');
            let allNotApplicable = true;
            let hasSelection = false;
            
            items.forEach(item => {
                const statusRadios = item.querySelectorAll('input[name^="status-"]:checked');
                if (statusRadios.length > 0) {
                    hasSelection = true;
                    if (statusRadios[0].value !== 'not-applicable') {
                        allNotApplicable = false;
                    }
                }
            });
            
            // 如果有选择且全部都是"无此项"，则保持折叠状态
            if (hasSelection && allNotApplicable) {
                const categoryItems = wrapper.querySelector('.category-items');
                if (categoryItems && categoryItems.style.display !== 'none') {
                    categoryItems.style.display = 'none';
                    wrapper.classList.add('collapsed');
                }
            }
            // 在移动端，不自动展开类别，需要用户手动点击
        });
    }
    
    // 桌面端类别自动折叠检查
    function checkDesktopCategoryAutoCollapse() {
        const categoryWrappers = document.querySelectorAll('.category-wrapper');
        categoryWrappers.forEach(wrapper => {
            const items = wrapper.querySelectorAll('.item');
            let allNotApplicable = true;
            let hasAllSelections = true;
            
            items.forEach(item => {
                const statusRadios = item.querySelectorAll('input[name^="status-"]:checked');
                if (statusRadios.length === 0) {
                    hasAllSelections = false;
                } else if (statusRadios[0].value !== 'not-applicable') {
                    allNotApplicable = false;
                }
            });
            
            // 只有当所有项目都有选择且全部都是"无此项"时，才折叠
            if (hasAllSelections && allNotApplicable) {
                const categoryItems = wrapper.querySelector('.category-items');
                if (categoryItems && categoryItems.style.display !== 'none') {
                    categoryItems.style.display = 'none';
                    wrapper.classList.add('collapsed');
                }
            } else if (!allNotApplicable) {
                // 如果不是全部"无此项"，确保类别是展开的
                const categoryItems = wrapper.querySelector('.category-items');
                if (categoryItems && categoryItems.style.display === 'none') {
                    categoryItems.style.display = '';
                    wrapper.classList.remove('collapsed');
                }
            }
        });
    }

    form.addEventListener('change', handleRadioChange);
    checklistContainer.addEventListener('change', handleRadioChange);

    // 全局事件委托：保证任何时候点击严重程度/概率都能高亮并更新风险
    document.addEventListener('change', (e) => {
        if (e.target && e.target.matches('.severity-section input[type="radio"]')) {
            const section = e.target.closest('.severity-section');
            if (section) section.querySelectorAll('label').forEach(l => l.classList.remove('selected'));
            e.target.parentElement.classList.add('selected');
            const itemId = e.target.name.replace('severity-','');
            updateItemRiskDisplay(itemId);
        } else if (e.target && e.target.matches('.probability-section input[type="radio"]')) {
            const section = e.target.closest('.probability-section');
            if (section) section.querySelectorAll('label').forEach(l => l.classList.remove('selected'));
            e.target.parentElement.classList.add('selected');
            const itemId = e.target.name.replace('probability-','');
            updateItemRiskDisplay(itemId);
        }
    });


    // --- All other functions (calculateResults, displayResults, etc.) remain unchanged ---
    // 为移动端和桌面端都添加事件监听器
    const calculateBtn = document.getElementById('calculate-btn');
    const saveResultBtn = document.getElementById('save-result-btn');
    const viewHistoryBtn = document.getElementById('view-history-btn');
    const clearAllHistoryBtn = document.getElementById('clear-all-history-btn');
    const closeBtn = document.querySelector('.close');
    
    // 计算按钮 - 支持点击和触摸
    calculateBtn.addEventListener('click', calculateResults);
    calculateBtn.addEventListener('touchend', function(e) {
        e.preventDefault();
        calculateResults();
    });
    
    // 保存结果按钮 - 支持点击和触摸
    saveResultBtn.addEventListener('click', saveCurrentResult);
    saveResultBtn.addEventListener('touchend', function(e) {
        e.preventDefault();
        saveCurrentResult();
    });
    
    // 查看历史按钮 - 支持点击和触摸
    viewHistoryBtn.addEventListener('click', showHistoryModal);
    viewHistoryBtn.addEventListener('touchend', function(e) {
        e.preventDefault();
        showHistoryModal();
    });
    
    // 清空历史按钮 - 支持点击和触摸
    clearAllHistoryBtn.addEventListener('click', clearAllHistory);
    clearAllHistoryBtn.addEventListener('touchend', function(e) {
        e.preventDefault();
        clearAllHistory();
    });
    
    // 关闭按钮 - 支持点击和触摸
    closeBtn.addEventListener('click', closeHistoryModal);
    closeBtn.addEventListener('touchend', function(e) {
        e.preventDefault();
        closeHistoryModal();
    });
    window.addEventListener('click', (e) => {
        if (e.target === document.getElementById('history-modal')) {
            closeHistoryModal();
        }
    });
    
    // 监听窗口大小变化
    window.addEventListener('resize', () => {
        setTimeout(() => {
            initializePage();
            // 重新检测严重程度和概率等级选项数量
            detectSeverityOptions();
        }, 100);
    });
});

// 检测严重程度和概率等级选项数量并添加相应的CSS类
function detectSeverityOptions() {
    const severitySections = document.querySelectorAll('.severity-section');
    severitySections.forEach(section => {
        const labels = section.querySelectorAll('label');
        // 清除所有选项数量相关的类
        section.classList.remove('two-options', 'four-options');
        
        if (labels.length === 2) {
            section.classList.add('two-options');
            console.log('Added two-options class to section with 2 labels');
        } else if (labels.length === 4) {
            section.classList.add('four-options');
            console.log('Added four-options class to section with 4 labels');
        }
    });
    
    const probabilitySections = document.querySelectorAll('.probability-section');
    probabilitySections.forEach(section => {
        const labels = section.querySelectorAll('label');
        if (labels.length === 6) {
            section.classList.add('six-options');
        } else {
            section.classList.remove('six-options');
        }
    });
}

// This function shows or hides the risk assessment selection based on the answer
function handleRiskOptionsDisplay(itemId, statusValue) {
    const riskOptionsDiv = document.getElementById(`risk-options-${itemId}`);
    const riskDisplay = document.getElementById(`current-risk-${itemId}`);
    
    if (statusValue === 'non-compliant') {
        // 显示严重程度和概率等级选择界面
        riskOptionsDiv.classList.add('show');
        if (riskDisplay) riskDisplay.style.display = 'block';
        
        // 如果严重程度只有一个选项，自动选中
        const sevRadios = riskOptionsDiv.querySelectorAll('.severity-section input[type="radio"]');
        if (sevRadios && sevRadios.length === 1) {
            sevRadios[0].checked = true;
            const lbl = sevRadios[0].parentElement;
            if (lbl) lbl.classList.add('selected');
        }
        
        // 如果概率只有一个选项（如仅D），自动选中
        const probRadios = riskOptionsDiv.querySelectorAll('.probability-section input[type="radio"]');
        if (probRadios && probRadios.length === 1) {
            probRadios[0].checked = true;
            const lbl = probRadios[0].parentElement;
            if (lbl) lbl.classList.add('selected');
        }
        // 清理并应用选中态样式（严重程度/概率）
        ['severity','probability'].forEach(group => {
            riskOptionsDiv.querySelectorAll(`.${group}-section label`).forEach(l => l.classList.remove('selected'));
            const checked = riskOptionsDiv.querySelector(`.${group}-section input[type="radio"]:checked`);
            if (checked) checked.parentElement.classList.add('selected');
        });
        // 实时刷新当前项目的风险显示
        updateItemRiskDisplay(itemId);
        // 检测并应用严重程度和概率等级选项样式
        detectSeverityOptions();
    } else {
        riskOptionsDiv.classList.remove('show');
        // 清除所有已选择的严重程度和概率等级
        riskOptionsDiv.querySelectorAll('input[type="radio"]').forEach(radio => radio.checked = false);
        if (riskDisplay) riskDisplay.style.display = 'none';
        // 同步清空已显示的风险类别
        const badge = document.getElementById(`risk-badge-${itemId}`);
        if (badge) {
            badge.textContent = '';
            badge.className = 'risk-item-category';
        }
    }
}

// 根据严重程度与概率映射到风险类别
function mapRiskCategory(severity, probability) {
    const code = `${severity}${probability}`;
    if (['1A','1B','1C','1D','2A','2B','2C','3A','3B'].includes(code)) return 'I';
    if (['1E','2D','2E','3C','3D','4A','4B'].includes(code)) return 'Ⅱ';
    if (['1F','2F','3E','3F','4C','4D','4E','4F'].includes(code)) return 'Ⅲ';
    return '';
}

// 实时更新某条目的风险代码与风险类别展示
function updateItemRiskDisplay(itemId) {
    const riskDisplay = document.getElementById(`current-risk-${itemId}`);
    const badge = document.getElementById(`risk-badge-${itemId}`);
    if (!riskDisplay || !badge) return;

    const sev = document.querySelector(`input[name="severity-${itemId}"]:checked`);
    const prob = document.querySelector(`input[name="probability-${itemId}"]:checked`);

    if (sev && prob) {
        const category = mapRiskCategory(parseInt(sev.value), prob.value);
        badge.textContent = `风险类别${category}`;
        badge.className = `risk-item-category ${category}`;
        riskDisplay.style.display = 'block';
    } else {
        badge.textContent = '';
        badge.className = 'risk-item-category';
    }
}

// The rest of your JavaScript functions (calculateResults, displayResults, saveCurrentResult, etc.)
// can remain exactly as they were in the original file.
// Copy and paste them below this line.
// ... (Paste the original calculateResults, displayResults, and all history-related functions here)
function findItemById(id) {
    for (const cat of evaluationData) {
        const found = cat.items.find(item => item.id === id);
        if (found) return found;
    }
    return null;
}

function calculateResults() {
    let n = 0;
    let v_sum = 0;
    let hasCategoryI = false;
    let incompleteItem = null;
    const categoryCounts = { I: 0, 'Ⅱ': 0, Ⅲ: 0, Unspecified: 0 };
    const riskItems = []; // 收集风险类别I和Ⅱ的项目
    const notApplicableItems = []; // 收集被标识为"无此项"的项目
    let totalNotApplicable = 0; // 统计"无此项"项目的总数

    // 统计所有项目
    evaluationData.forEach(cat => {
        
        let categoryNotApplicable = true; // 检查整个大项是否都是"无此项"
        const categoryNotApplicableItems = []; // 收集该大项中"无此项"的小项
        
        cat.items.forEach(item => {
            const status = document.querySelector(`input[name="status-${item.id}"]:checked`);
            if (status) {
                if (status.value === 'not-applicable') {
                    categoryNotApplicableItems.push({
                        id: item.id,
                        name: item.name,
                        content: item.content
                    });
                    totalNotApplicable++; // 增加"无此项"计数
                    return;
                } else {
                    categoryNotApplicable = false;
                }
                n++;
                let riskCategory = '';
                if (status.value === 'compliant') {
                    riskCategory = 'Ⅲ';
                } else if (status.value === 'non-compliant') {
                    // 根据严重程度和概率等级确定风险类别
                    const selectedSeverity = document.querySelector(`input[name="severity-${item.id}"]:checked`);
                    const selectedProbability = document.querySelector(`input[name="probability-${item.id}"]:checked`);
                    
                    if (selectedSeverity && selectedProbability) {
                        // 根据严重程度和概率等级的组合确定风险类别
                        const severity = parseInt(selectedSeverity.value);
                        const probability = selectedProbability.value;
                        
                        // 根据风险等级对照表确定风险类别
                        // 构建风险等级代码 (如: 1A, 2B, 3C等)
                        const riskCode = severity + probability;
                        
                        // 风险类别 I: 1A、1B、1C、1D、2A、2B、2C、3A、3B
                        if (['1A', '1B', '1C', '1D', '2A', '2B', '2C', '3A', '3B'].includes(riskCode)) {
                            riskCategory = 'I';
                        }
                        // 风险类别 II: 1E、2D、2E、3C、3D、4A、4B
                        else if (['1E', '2D', '2E', '3C', '3D', '4A', '4B'].includes(riskCode)) {
                            riskCategory = 'Ⅱ';
                        }
                        // 风险类别 III: 1F、2F、3E、3F、4C、4D、4E、4F
                        else if (['1F', '2F', '3E', '3F', '4C', '4D', '4E', '4F'].includes(riskCode)) {
                            riskCategory = 'Ⅲ';
                        }
                        // 默认情况
                        else {
                            riskCategory = 'Ⅲ';
                        }

                        // 实时更新当前项目的风险显示
                        const riskDisplay = document.getElementById(`current-risk-${item.id}`);
                        const badge = document.getElementById(`risk-badge-${item.id}`);
                        if (riskDisplay && badge) {
                            const codeSpan = riskDisplay.querySelector('.risk-code');
                            if (codeSpan) codeSpan.textContent = riskCode;
                            badge.textContent = `风险类别${riskCategory}`;
                            badge.className = `risk-item-category ${riskCategory}`;
                            riskDisplay.style.display = 'block';
                        }
                    } else {
                        // 检查所有不完整的项目
                        if (!incompleteItem) {
                            incompleteItem = item;
                        }
                    }
                }
                if(riskCategory) {
                    categoryCounts[riskCategory]++;
                    let v = 0;
                    if (riskCategory === 'I') {
                        v = -3;
                        // 收集风险类别I的项目
                        riskItems.push({
                            id: item.id,
                            name: item.name,
                            category: riskCategory,
                            content: item.content
                        });
                    } else if (riskCategory === 'Ⅱ') {
                        v = -1;
                        // 收集风险类别Ⅱ的项目
                        riskItems.push({
                            id: item.id,
                            name: item.name,
                            category: riskCategory,
                            content: item.content
                        });
                    } else if (riskCategory === 'Ⅲ') {
                        v = 2;
                    }
                    v_sum += v;
                }
            }
        });
        
        // 如果整个大项都是"无此项"，记录大项
        if (categoryNotApplicable && categoryNotApplicableItems.length > 0) {
            notApplicableItems.push({
                category: cat.category,
                type: 'category',
                items: categoryNotApplicableItems
            });
        } else if (categoryNotApplicableItems.length > 0) {
            // 如果只有部分小项是"无此项"，记录小项
            notApplicableItems.push({
                category: cat.category,
                type: 'items',
                items: categoryNotApplicableItems
            });
        }
    });
    
    // 统计C、D项
    checklistData.forEach(cat => {
        // C、D项都参与统计，不跳过任何部分
        
        let categoryNotApplicable = true;
        const categoryNotApplicableItems = [];
        
        cat.items.forEach(item => {
            const status = document.querySelector(`input[name="status-${item.id}"]:checked`);
            if (status) {
                if (status.value === 'not-applicable') {
                    categoryNotApplicableItems.push({
                        id: item.id,
                        name: item.name,
                        content: item.content
                    });
                    totalNotApplicable++; // 增加"无此项"计数
                    return;
                } else {
                    categoryNotApplicable = false;
                }
                n++;
                let riskCategory = '';
                if (status.value === 'compliant') {
                    riskCategory = 'Ⅲ';
                } else { // non-compliant
                    // 根据严重程度和概率等级确定风险类别
                    const selectedSeverity = document.querySelector(`input[name="severity-${item.id}"]:checked`);
                    const selectedProbability = document.querySelector(`input[name="probability-${item.id}"]:checked`);
                    
                    if (selectedSeverity && selectedProbability) {
                        // 根据严重程度和概率等级的组合确定风险类别
                        const severity = parseInt(selectedSeverity.value);
                        const probability = selectedProbability.value;
                        
                        // 根据风险等级对照表确定风险类别
                        // 构建风险等级代码 (如: 1A, 2B, 3C等)
                        const riskCode = severity + probability;
                        
                        // 风险类别 I: 1A、1B、1C、1D、2A、2B、2C、3A、3B
                        if (['1A', '1B', '1C', '1D', '2A', '2B', '2C', '3A', '3B'].includes(riskCode)) {
                            riskCategory = 'I';
                        }
                        // 风险类别 II: 1E、2D、2E、3C、3D、4A、4B
                        else if (['1E', '2D', '2E', '3C', '3D', '4A', '4B'].includes(riskCode)) {
                            riskCategory = 'Ⅱ';
                        }
                        // 风险类别 III: 1F、2F、3E、3F、4C、4D、4E、4F
                        else if (['1F', '2F', '3E', '3F', '4C', '4D', '4E', '4F'].includes(riskCode)) {
                            riskCategory = 'Ⅲ';
                        }
                        // 默认情况
                        else {
                            riskCategory = 'Ⅲ';
                        }
                    } else {
                        // C、D项通常都有C级和D级选项，所以需要用户选择
                        // 检查所有C、D项的不完整项目
                        if (!incompleteItem) {
                            incompleteItem = item;
                        }
                    }
                }
                if(riskCategory) {
                    categoryCounts[riskCategory]++;
                    let v = 0;
                    if (riskCategory === 'I') {
                        v = -3;
                        // 收集风险类别I的项目
                        riskItems.push({
                            id: item.id,
                            name: item.name,
                            category: riskCategory,
                            content: item.content
                        });
                    } else if (riskCategory === 'Ⅱ') {
                        v = -1;
                        // 收集风险类别Ⅱ的项目
                        riskItems.push({
                            id: item.id,
                            name: item.name,
                            category: riskCategory,
                            content: item.content
                        });
                    } else if (riskCategory === 'Ⅲ') {
                        v = 2;
                    }
                    v_sum += v;
                }
            }
        });
        
        // 处理C、D项的"无此项"记录
        if (categoryNotApplicable && categoryNotApplicableItems.length > 0) {
            notApplicableItems.push({
                category: cat.category,
                type: 'category',
                items: categoryNotApplicableItems
            });
        } else if (categoryNotApplicableItems.length > 0) {
            notApplicableItems.push({
                category: cat.category,
                type: 'items',
                items: categoryNotApplicableItems
            });
        }
    });

    if (n === 0) {
        alert('请至少评估一个项目！');
        return;
    }

    if (incompleteItem) {
        alert(`项目 ${incompleteItem.id} (${incompleteItem.name}) 被评为"不符合"，但未选择严重程度和概率等级。请完成后再计算。`);
        const elementToScroll = document.getElementById(`item-${incompleteItem.id}`);
        elementToScroll.scrollIntoView({ behavior: 'smooth', block: 'center' });
        elementToScroll.style.border = '2px solid red';
        setTimeout(()=> {
            elementToScroll.style.border = '1px solid #e0e6ed';
        }, 3000);
        return;
    }
    
    let G = 0;
    // 根据GBT 42615-2023标准：当存在高风险项（风险类别I）时，综合安全状况得分(G)为0
    if (categoryCounts['I'] > 0) {
        G = 0;
    } else if (v_sum < 0) {
        G = 0;
    } else {
        G = (100 * v_sum) / (2 * n);
    }
    G = Math.round(G * 100) / 100;

    let level = '';
    let conclusion = '';

    if (G >= 90) {
        level = '一级';
        conclusion = '宜采取防护措施消除或降低风险。';
    } else if (G >= 75) {
        level = '二级';
        conclusion = '应采取防护措施消除或降低风险。';
    } else if (G >= 60) {
        level = '三级';
        conclusion = '尽快采取防护措施消除或降低风险。';
    } else {
        level = '四级';
        conclusion = '建议立即停止使用，应采取防护措施消除或降低风险后方可使用。';
    }

    displayResults(n, categoryCounts, G, level, conclusion, riskItems, notApplicableItems, totalNotApplicable);
}

function displayResults(n, counts, G, level, conclusionText, riskItems, notApplicableItems, totalNotApplicable) {
    const resultsDiv = document.getElementById('results');
    resultsDiv.style.display = 'block';
    
    document.getElementById('summary').innerHTML = `
        <b>已评估项目总数:</b> ${n} &nbsp;&nbsp; <b>无此项项目总数:</b> ${totalNotApplicable}<br>
        <b>风险类别 I (高风险项):</b> ${counts['I'] || 0} 项 &nbsp;&nbsp; 
        <b>风险类别 Ⅱ (需复查项):</b> ${counts['Ⅱ']} 项 &nbsp;&nbsp; 
        <b>风险类别 Ⅲ (符合要求项):</b> ${counts['Ⅲ']} 项
    `;
    
    document.getElementById('score').innerHTML = `<b>综合安全状况得分 (G):</b> ${G}`;
    document.getElementById('level').innerHTML = `<b>综合安全状况等级:</b> ${level}`;
    document.getElementById('conclusion').textContent = conclusionText;

    // 风险项目展示
    const riskSection = document.getElementById('risk-items-section');
    const riskList = document.getElementById('risk-items-list');
    if (riskItems && riskItems.length > 0) {
        riskSection.style.display = '';
        riskList.innerHTML = riskItems.map(item => `
            <div class="risk-item category-${item.category}">
                <div class="risk-item-header">${item.id} ${item.name}
                    <span class="risk-item-category ${item.category}">风险类别${item.category}</span>
                </div>
                <div class="risk-item-content">${item.content.replace(/\n/g, '<br>')}</div>
            </div>
        `).join('');
    } else {
        riskSection.style.display = 'none';
        riskList.innerHTML = '';
    }

    // 无此项项目展示
    const notApplicableSection = document.getElementById('not-applicable-items-section');
    const notApplicableList = document.getElementById('not-applicable-items-list');
    if (notApplicableItems && notApplicableItems.length > 0) {
        notApplicableSection.style.display = '';
        notApplicableList.innerHTML = notApplicableItems.map(item => {
            if (item.type === 'category') {
                return `<div class="not-applicable-item category"><div class="not-applicable-item-header">${item.category} (整个大项无此项)</div></div>`;
            } else {
                return `
                    <div class="not-applicable-item items">
                        <div class="not-applicable-item-header">${item.category} (部分项目无此项)</div>
                        <div class="not-applicable-item-content">
                            <ul>
                                ${item.items.map(subItem => `<li><strong>${subItem.id} ${subItem.name}</strong></li>`).join('')}
                            </ul>
                        </div>
                    </div>
                `;
            }
        }).join('');
    } else {
        notApplicableSection.style.display = 'none';
        notApplicableList.innerHTML = '';
    }

    resultsDiv.scrollIntoView({ behavior: 'smooth' });
}


function saveCurrentResult() {
    let title = prompt('请输入此台电梯评估结果的标题（可选）：', 'XX大厦X号电梯');
    if (title === null) return;
    
    const summary = document.getElementById('summary').innerHTML;
    const score = document.getElementById('score').innerHTML;
    const level = document.getElementById('level').innerHTML;
    const conclusion = document.getElementById('conclusion').textContent;
    const riskList = document.getElementById('risk-items-list').innerHTML;
    const notApplicableList = document.getElementById('not-applicable-items-list').innerHTML;
    const now = new Date();
    const timeStr = now.toLocaleString('zh-CN');
    const record = {
        title: title || '未命名',
        time: timeStr,
        summary,
        score,
        level,
        conclusion,
        riskList,
        notApplicableList
    };
    let history = JSON.parse(localStorage.getItem('evaluationHistory') || '[]');
    history.unshift(record);
    if (history.length > 10) history = history.slice(0, 10);
    localStorage.setItem('evaluationHistory', JSON.stringify(history));
    alert('当前评估结果已保存！');
}

function showHistoryModal() {
    const modal = document.getElementById('history-modal');
    const listDiv = document.getElementById('history-list');
    let history = JSON.parse(localStorage.getItem('evaluationHistory') || '[]');
    if (history.length === 0) {
        listDiv.innerHTML = '<p>暂无历史记录。</p>';
    } else {
        listDiv.innerHTML = history.map((rec, idx) => `
            <div class="history-item" data-idx="${idx}">
                <div class="history-item-header">
                    <div class="history-item-info">
                        <div class="history-item-title">${rec.title || '未命名评估'}</div>
                        <div class="history-item-time">${rec.time}</div>
                    </div>
                    <button type="button" class="delete-history-btn" data-idx="${idx}" title="删除此记录">×</button>
                </div>
                <div class="history-item-details">${rec.summary}<br>${rec.score}<br>${rec.level}</div>
            </div>
        `).join('');
        
        listDiv.querySelectorAll('.delete-history-btn').forEach(btn => {
            btn.addEventListener('click', (e) => {
                e.stopPropagation();
                const idx = parseInt(btn.getAttribute('data-idx'));
                deleteHistoryItem(idx);
            });
        });
    }
    modal.style.display = 'block';
    Array.from(listDiv.getElementsByClassName('history-item')).forEach(item => {
        item.onclick = function(e) {
            if (e.target.classList.contains('delete-history-btn')) return;
            const idx = this.getAttribute('data-idx');
            showHistoryDetail(idx);
        };
    });
}

function deleteHistoryItem(idx) {
    if (confirm('确定要删除这条历史记录吗？')) {
        let history = JSON.parse(localStorage.getItem('evaluationHistory') || '[]');
        history.splice(idx, 1);
        localStorage.setItem('evaluationHistory', JSON.stringify(history));
        showHistoryModal();
    }
}

function closeHistoryModal() {
    document.getElementById('history-modal').style.display = 'none';
}

function showHistoryDetail(idx) {
    let history = JSON.parse(localStorage.getItem('evaluationHistory') || '[]');
    if (!history[idx]) return;
    const rec = history[idx];
    document.getElementById('results').style.display = 'block';
    document.getElementById('summary').innerHTML = rec.summary;
    document.getElementById('score').innerHTML = rec.score;
    document.getElementById('level').innerHTML = rec.level;
    document.getElementById('conclusion').textContent = rec.conclusion;
    document.getElementById('risk-items-section').style.display = rec.riskList ? '' : 'none';
    document.getElementById('risk-items-list').innerHTML = rec.riskList || '';
    document.getElementById('not-applicable-items-section').style.display = rec.notApplicableList ? '' : 'none';
    document.getElementById('not-applicable-items-list').innerHTML = rec.notApplicableList || '';
    closeHistoryModal();
}

function clearAllHistory() {
    if (confirm('确定要清空所有历史记录吗？此操作不可恢复！')) {
        localStorage.removeItem('evaluationHistory');
        alert('所有历史记录已清除！');
        showHistoryModal();
    }
}